"use strict";app.utils.getData=null,app.utils.getScrollPosition=function(){return void 0!==window.scrollY?window.scrollY:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:0},app.utils.okonchanie=function(e,t,i,a){var n=parseInt(e)!==parseFloat(e);return(e+="").length>1&&"1"==+e.substr(e.length-2,1)||+e.substr(e.length-1,1)>4&&+e.substr(e.length-1,1)<10&&!n?a:"1"!=e.substr(e.length-1,1)||n?i:t},app.utils.isIPhone=function(){return/iPhone|iPod/i.test(navigator.userAgent)},app.utils.parseUrlQuery=function(e){var t,i,a,n=e&&e.indexOf("?"),o={};if(e=e?-1!==n?e.substr(n+1):null:location.search&&location.search.substr(1))for(a=e.split("&"),t=0;t<a.length;t++)o[(i=a[t].split("="))[0]]=i[1];return o},app.utils.insertParam=function(e,t){e=encodeURI(e),t=encodeURI(t);for(var i,a=document.location.search.substr(1).split("&"),n=a.length;n--;)if((i=a[n].split("="))[0]==e){i[1]=t,a[n]=i.join("=");break}n<0&&(a[a.length]=[e,t].join("="));var o=[];return _.each(a,function(e,t){""!=e&&o.push(e)}),"?"+o.join("&")},app.utils.insertParam2=function(e,t,i){return t=encodeURI(t),i=encodeURI(i),-1!==e.indexOf("?")?e+="&"+[t,i].join("="):e+="?"+[t,i].join("="),e},app.utils.scrollWidth=function(){var e=document.createElement("div");e.style.overflowY="scroll",e.style.width="50px",e.style.height="50px",e.style.visibility="hidden",document.body.appendChild(e);var t=e.offsetWidth-e.clientWidth;return document.body.removeChild(e),t},app.utils.doubleNumber=function(e){return 1===(e=e.toString()).length?"0"+e:e},app.utils.getDirection={direction:1,lastScrollTop:0,init:function(){var e=this;$(window).scroll(function(){var t=$(window).scrollTop();e.lastScrollTop<=t?e.direction=1:e.direction=-1,e.lastScrollTop=t})}},app.utils.heightLikeWindow=function(e,t){function i(){e.css({height:app.Size.height})}i(),app.on("resize",i,t)},app.utils.sizeLikeWindow=function(e,t){function i(t){e.css(t)}i(app.Size.getSize()),app.on("resize",i,t)},app.utils.getBackgroundImageUrl=function(e){return(e[0].currentStyle||window.getComputedStyle(e[0],!1)).backgroundImage.slice(4,-1).replace(/"/g,"")},app.utils.notify=function(e,t){t=t||2e3;var i=10,a=_.uniqueId("_");$(".notify").each(function(){i+=$(this).outerHeight(!0)});var n=$("<div/>").addClass("notify "+a).append(e).css({top:i}).hide();app.dom.$body.append(n.fadeIn()),setTimeout(function(){$(".notify."+a).fadeOut(function(){$(this).remove()})},t)},app.utils.detectDevice=function(){app.utils.isTableLand=!(forseDesktop||!device.tablet()||!device.landscape()),app.utils.isTablePort=!(forseDesktop||!device.tablet()||!device.portrait()),app.utils.isTablet=app.utils.isTableLand||app.utils.isTablePort,app.utils.isMobileLand=!(forseDesktop||!device.mobile()||!device.landscape()),app.utils.isMobilePort=!(forseDesktop||!device.mobile()||!device.portrait()),app.utils.isMobile=app.utils.isMobileLand||app.utils.isMobilePort,app.utils.isDesktop=!app.utils.isMobile&&!app.utils.isTablet,device.landscape()?app.dom.$html.removeClass("portrait").addClass("landscape"):device.portrait()&&app.dom.$html.removeClass("landscape").addClass("portrait")},app.utils.detectDevice(),app.dom.$window.on("resize orientationchange",function(){return app.utils.detectDevice()}),app.components.Loader=function(){function e(){var e=this;this.obj=null,this.isVisilbe=!1,this.nobg=!1,e.obj=$(".js-loader")}return e.prototype.show=function(){return this.isVisilbe||(this.nobg&&this.obj.addClass("_nobg"),this.obj.fadeIn(300,function(){}),this.isVisilbe=!0),this},e.prototype.hide=function(e){var t=this;t.isVisilbe&&(t.obj.stop().fadeOut(1e3).removeClass("_nobg"),t.nobg=!1,t.isVisilbe=!1)},new e}(),app.Size=function(){var e=300;function t(){var t,i,a=this,n=/iPod|iPad|iPhone/g.test(navigator.userAgent)?"orientationchange load":"resize load";a.width=null,a.height=null,a.orientationChange=(t=a.orientationChange,i=a,function(){return t.apply(i,arguments)}),/android/gi.test(navigator.userAgent)?app.dom.$window.on("load",function(){return setTimeout(a.orientationChange,e)}):app.dom.$window.on(n,a.orientationChange),a.orientationChange()}return t.prototype={orientationChange:function(){var e=this.height,t=this.width;this.height=Modernizr.touch?window.innerHeight:app.dom.$window.height(),this.width=app.dom.$window.width(),this.width=Math.max(320,this.width),this.height=Math.max(212,this.height),this.width===t&&this.height===e||app.trigger("resize",this.getSize())},getSize:function(){return{width:this.width,height:this.height}}},new t}(),app.components.Multiloader=function(){var e=function(e){this._queue=[],this._callback=null,this._minQueue=e||0,this._lastCreatedStack=0;for(var t=0;t<this._minQueue;t++)this._queue.push(!1)};return e.prototype.addCallback=function(e,t){this._callback=e,this._scope=t||this},e.prototype.createStack=function(){var e=this,t=e._lastCreatedStack++;return t>this._queue.length-1&&e._queue.push(!1),function(){e._checkStack(t)}},e.prototype._checkStack=function(e){this._queue[e]=!0,_.every(this._queue)&&"function"==typeof this._callback&&this._callback.apply(this._scope)},e}(),app.components.CanvasSequenceUniq=function(e){var t,i,a,n,o=this,s=e.obj,r=e.width,l=e.height,d=0,c=0,p=r/l,u=[],f=s.data("from"),h=s.data("to"),m=s.data("prefix"),v=s.data("affix"),g=s.data("full-number"),w=s.data("imgs"),b=s[0].getContext("2d"),y=new app.components.Multiloader(h-f+1),k=0,C=0,x=e.afterLoad,S=e.afterLoadPart,P=e.afterLoadFirstImg,M=e.afterSequenceFinish,I=e.afterOneSequence,T="boolean"!=typeof e.showRender||e.showRender,z=null,F=!1;function V(){var e=s.parent();d=e.width(),c=e.height(),d/c>p?(r=d,l=d/p,s.css({marginTop:(c-l)/2,marginLeft:0})):(r=c*p,l=c,s.css({marginTop:0,marginLeft:(d-r)/2})),s[0].width=r,s[0].height=l}this.oneSequence=function(e){b.clearRect(k,C,r,l),T&&b.drawImage(u[e-1].image,k,C,r,l),e,$.isFunction(I)&&I(e)},this.sequenceFinish=function(e){$.isFunction(M)&&M(e)},this.setShowRender=function(e){T="boolean"!=typeof e||e},this.startLoad=function(){_.each(u,function(e,t){t>0&&(e.image.src=e.url)})},this.startLoadPart=function(e,t,i){F=!0,(n=new app.components.Multiloader(t-e+1)).addCallback(function(){F=!1,i||(z=new SequenceAnimate(u.length,o.oneSequence,o.sequenceFinish)),$.isFunction(S)&&S(s,z)}),e&&t&&_.each(u,function(i,a){a>=e-1&&a<=t-1&&(i.image.src=i.url)})},this.getSequence=function(){return z},this.getSize=function(){return{width:d,height:c}},function(){function e(){u[0].image==this&&(b.clearRect(k,C,r,l),b.drawImage(this,k,C,r,l)),F?n.createStack()():y.createStack()(),$.isFunction(P)&&P()}if(y.addCallback(function(){z=new SequenceAnimate(u.length,o.oneSequence,o.sequenceFinish),$.isFunction(x)&&x(s,z)}),w)_.each(w,function(t,a){(i=new Image).onload=e,u.push({image:i,url:t}),0===a&&(i.src=t)});else for(t=f;t<=h;t++)(i=new Image).onload=e,a=g?app.utils.doubleNumber(t):t,u.push({image:i,url:m+a+v}),t===f&&(i.src=m+a+v);V(),app.on("resize",V)}()},function(){var e=".friend-popup",t=app.subViews.FriendPopup=Backbone.View.extend({el:e,events:{},initialize:function(){t.__super__.initialize.apply(this,arguments)},remove:function(){t.__super__.remove.apply(this,arguments),app.dom.$document.off(".friendForm")},render:function(){t.__super__.render.apply(this,arguments);this.bind("data-friend-name","data-friend-input"),this.bind("data-sender-name","data-sender-input")},bind:function(e,t){var i=app.dom.$document.find("["+e+"]"),a=app.dom.$document.find("["+t+"]"),n=i.attr(e)||"______";function o(){var e=a.val();e.length>0?i.html(e):i.html(n)}o(),app.dom.$document.on("input.friendForm","["+t+"]",_.debounce(function(){o()},100))}});t.el=e}(),function(){var e=app.dom.$html,t=app.subViews.IssueMap=Backbone.View.extend({el:e,events:{},initialize:function(){t.__super__.initialize.apply(this,arguments)},remove:function(){t.__super__.remove.apply(this,arguments),app.dom.$document.off(".metroSelects"),app.dom.$document.off(".issueList")},render:function(e){t.__super__.render.apply(this,arguments);this.initIssueMap(e)},initIssueMap:function(e){var t=this,i=$("[data-flexcroll]");if(setTimeout(function(){i.length&&(i[0].scrollHeight-i[0].clientHeight>0&&fleXenv.fleXcrollMain(i[0]),app.utils.isMobile&&i.hide())},10),app.GlobalView.mapLoaded)t.issueMap(e);else{var a=document.createElement("script");a.type="text/javascript",a.src="https://api-maps.yandex.ru/2.1/?lang=ru_RU&onload=initialize",document.body.appendChild(a),window.initialize=function(){app.GlobalView.mapLoaded=!0,t.issueMap(e)}}},issueMap:function(e){var t,i=this,a=$(".fancybox-inner [data-popup="+e+"]"),n=a.find("[data-issue-map]"),o=n.data("xcoord"),s=n.data("ycoord"),r=a.find("[data-zoom-plus]"),l=a.find("[data-zoom-minus]"),d=a.find("[data-flexcroll]"),c=a.find("[data-issues-list]").find("[data-issue]"),p=null,u=[],f=10,h=a.find("[data-filter]"),m=h.find("[data-filter-s]"),v=h.find("[data-filter-line]"),g=h.find("[data-filter-station]"),w=h.find("[data-filter-relation-line-station]");function b(){var e=null,i=$("<div/>").addClass("no-results"),a=w.filter(":visible").find(g),n=v.val(),o=a.val();c.hide(),e=!app.utils.isMobile&&h.length?t.searchIntersect(p).search(function(e){var t=$.trim(m.val()),i=new RegExp(t,"gi"),s=function(){var t=e.options.get("$dom");return(t.find(".shops-list__item-metro-name").text()+" "+t.find(".shops-list__item-name").text()+" "+t.find(".shops-list__item-address").text()).replace(/[,\.«»]/gi,"").replace(/\s/g," ").toLowerCase()};return!("all"!==n&&!e.options.get("$dom").data("issue").lineIds[v.val()])&&("all"===n&&"all"===o&&""!==t?s().match(i):"all"===o?!e.options.get("$dom").data("issue").lineIds[v.val()]||""===t||s().match(i):e.options.get("$dom").data("issue").stationIds[a.val()]&&""!==t?s().match(i):e.options.get("$dom").data("issue").stationIds[a.val()])}).addToMap(p).each(function(e){e.options.get("$dom").show()}):t.searchIntersect(p).addToMap(p).each(function(e){e.options.get("$dom").show()}),t.remove(e).removeFromMap(p),setTimeout(function(){d[0].scrollHeight-d[0].clientHeight>0&&fleXenv.fleXcrollMain(d[0])},10),app.utils.isMobile||($(".no-results").remove(),$(".shops-list__inner").children(":visible").length||(p._zoom>f?$(".shops-list__inner").prepend(i.html("По вашему запросу ничего не найдено. Попробуйте расширить область поиска, изменив масштаб карты.")):"all"!==n||"all"!==o?$(".shops-list__inner").prepend(i.html("По вашему запросу ничего не найдено. Попробуйте расширить область поиска, сбросив фильтр по метро.")):$(".shops-list__inner").prepend(i.html("По вашему запросу ничего не найдено."))))}function y(t){var i,a,n;app.GlobalView.lastCoord={},app.GlobalView.lastCoord.y=t.lat,app.GlobalView.lastCoord.x=t.lan,app.GlobalView.currentView.cartMap?(SelectPvz(t.id),$.fancybox.close()):app.GlobalView.currentView.detailMap&&($.fancybox.close(),i=t.id,a=e.replace(/salonsAvailibility/i,""),n=e.replace(/salonsAvailibility/i,"salonsAvailibilityForm"),$("[data-salons-availibility="+e+"]").click(),$(".fancybox-inner [data-popup="+n+"]").find("[data-selected-salon]").val(i),$(".fancybox-inner [data-popup="+n+"]").find('input[name="product-id"]').val(a))}ymaps.ready(function(){!function(){o||(o=37.622504);s||(s=55.753215);app.GlobalView.lastCoord&&(o=app.GlobalView.lastCoord.x,s=app.GlobalView.lastCoord.y);p=new ymaps.Map(n[0],{center:[s,o],zoom:f,autoFitToViewport:"always",controls:[]}),new ymaps.Clusterer({clusterNumbers:[10],clusterIconContentLayout:null}),i.myMap&&i.myMap.destroy();i.myMap=p,p.behaviors.disable(["scrollZoom"]);var e=new ymaps.control.SearchControl,a={position:{right:app.utils.isMobile?"calc(100vw - 7.5rem)":32,top:app.utils.isMobile?"calc(100vh - 11rem)":20},size:app.utils.isMobile?"small":"auto"};p.controls.add(e,a),setTimeout(function(){d[0].scrollHeight-d[0].clientHeight>0&&fleXenv.fleXcrollMain(d[0])},10),c.each(function(){var e=$(this),t=e.data("issue"),i="svyaznoy";t.type&&(i=t.type);var a=ymaps.templateLayoutFactory.createClass(e.next("[data-balloon-content]").html(),{build:function(){a.superclass.build.call(this),$(".js-balloon").bind("click",this.onLinkClick);var e=$(this._parentElement.offsetParent.offsetParent),t=e.outerHeight(),i=n.outerHeight(),o=i/2.5;t>=o&&app.dom.$document.find(".map-zoom").addClass("is-shifted")},clear:function(){$(".js-balloon").unbind("click",this.onLinkClick),a.superclass.clear.call(this),app.dom.$document.find(".map-zoom").removeClass("is-shifted")},onLinkClick:function(){y(t)}}),o=new ymaps.Placemark([t.lat,t.lan],{},{balloonContentLayout:a,balloonPanelMaxMapArea:app.utils.isMobile?1/0:0,iconLayout:"default#image",iconImageHref:t.type?"static/theme/images/icons/mark_"+i+".svg":"static/theme/images/icons/mark.png",iconImageSize:t.type?[22,28]:[44,57],iconImageOffset:t.type?[-11,-28]:[-22,-57],$dom:e});e.data("Placemark",o),u.push(o),e.click(function(){y(t)})}),t=ymaps.geoQuery(u),p.events.add("boundschange",function(){b()}),b()}(),r.click(function(e){e.preventDefault(),p.setZoom(p.getZoom()+1)}),l.click(function(e){e.preventDefault(),p.setZoom(p.getZoom()-1)}),function(){if(app.utils.isMobile)return;app.dom.$document.off(".metroSelects"),app.dom.$document.on("change.metroSelects","[data-filter-line]",function(){var e=$(this);w.hide().filter("[data-filter-relation-line-station='"+e.val()+"']").show(),b()}),app.dom.$document.on("change.metroSelects","[data-filter-station]",b),app.dom.$document.on("input.metroSelects","[data-filter-s]",_.debounce(b,100))}(),app.dom.$document.off(".issueList"),app.dom.$document.on("click.issueList","[data-issue-btn]",function(e){var t=app.dom.$document.find(".shops-list");t.slideToggle()})})}});t.el=e}(),function(){var e=app.dom.$document,t=app.subViews.MiniGall=Backbone.View.extend({el:e,events:{},initialize:function(){t.__super__.initialize.apply(this,arguments)},remove:function(){t.__super__.remove.apply(this,arguments)},render:function(e){if(t.__super__.render.apply(this,arguments),!device.mobile()){this.$el.find(e).each(function(){if(!$(this).find("div").length){var e=$(this),t=$("<div>"),i=e.find("span").length+1,a=100/i;if(i<2)return;for(var n=0;n<i;n++){var o=$("<div>").css({width:a+"%",height:"100%",left:n*a+"%",position:"absolute"}).mouseenter(function(){var e=$(this).css({"border-bottom":"0.5rem solid #bb559d"}),t=e.index(),i=e.parent();t&&i.parent().find("span:nth-of-type("+(t-1)+")").css({display:"block"}),i.find("span").show()}).mouseleave(function(){var e=$(this).css({"border-bottom":"none"}).parent();e.parent().find("span").css({display:"none"}),e.find("span").hide()});t.append(o)}t.prepend($("<span>").hide().css({position:"absolute","box-sizing":"border-box",width:"100%",height:"0.5rem",bottom:"-0.5rem",border:"1px solid #c5c5c5"})),e.css({position:"relative"}).prepend(t.css({position:"absolute",width:"100%",height:"100%"}))}})}}});t.el=e}(),function(){var e="[data-products-gall-wrap]",t=app.subViews.ProductsGall=Backbone.View.extend({el:e,events:{},initialize:function(){t.__super__.initialize.apply(this,arguments)},remove:function(){t.__super__.remove.apply(this,arguments)},render:function(){t.__super__.render.apply(this,arguments);var e=void 0;switch(!0){case device.mobile():e=2;break;case device.tablet():e=3;break;case device.desktop():default:e=4}this.$el.each(function(){var t=$(this),i=t.find("[data-products-gall]"),a=t.find("[data-products-gall-prev]"),n=t.find("[data-products-gall-next]");new Swiper(i[0],{nextButton:n,prevButton:a,slidesPerView:e,spaceBetween:0,onInit:function(e){var a=[],n=[],o=$(e.slides),s=app.dom.$html.css("font-size").replace("px",""),r=i.css("paddingBottom").replace("px",""),l=t.css("paddingBottom").replace("px","");o.each(function(){var e=$(this),t=e.find(".card__img:visible").outerHeight(!0)||0,i=e.find(".card__title:visible").outerHeight(!0)+10||10,o=e.find(".card__price:visible").outerHeight(!0)||0;a.push(t+i+o),n.push(i)}),o.find(".card__title:visible").css("height",_.max(n)/s+"rem"),o.css("height",_.max(a)/s+r/s+"rem"),t.css("height",_.max(a)/s+l/s+"rem")}})})}});t.el=e}(),function(){var e="[data-set]",t=app.subViews.SetGall=Backbone.View.extend({el:e,events:{"click [data-set-size-price]":"_e_changePriceBySize","click .set__checkbox":"_e_calcTotalPrice","click .set__order-btn":"_e_submitData"},selectors:{row:".set__row",item:"[data-set-item]",images:"[data-set-images]",name:".set__name",price:"[data-set-price]",priceBySize:"[data-set-size-price]",totalPrice:"[data-total-price]",totalPriceWithDiscount:"[data-total-price-discount]",discount:"[data-set-discount]",discount2:"[data-discount2]",discount3:"[data-discount3]",discount4:"[data-discount4]"},ids:[],subView:{MiniGall:new app.subViews.MiniGall},initialize:function(){t.__super__.initialize.apply(this,arguments)},remove:function(){t.__super__.remove.apply(this,arguments)},render:function(){t.__super__.render.apply(this,arguments);this._calcSizes(),this._calcTotalPrice(),this.subView.MiniGall.render(this.selectors.images)},_calcSizes:function(){if(!device.mobile()){var e=this;e.$el.each(function(){var t,i=$(this),a=i.find(e.selectors.row),n=i.find(e.selectors.item),o=n.find(e.selectors.images),s=n.length,r=100/s,l=app.dom.$html.css("font-size").replace("px",""),d=[],c=void 0;n.css({width:r+"%"}),t=o.outerWidth(),o.css({width:t/10+"rem",height:t/10+"rem"}),2===s?(c=n.outerWidth(!0),a.css({transform:"translateX(-"+c/2/10+"rem)"})):1===s&&(c=n.outerWidth(!0),a.css({transform:"translateX(-"+c/10+"rem)"}),n.find("[type=checkbox]").parent().hide()),n.each(function(){var t=$(this).find(e.selectors.name+":visible").outerHeight()||0;d.push(t)}),n.find(e.selectors.name+":visible").css("height",_.max(d)/l+"rem")})}},_calcTotalPrice:function(){var e,t=this,i=$(t.selectors.item),a=i.find("[type=checkbox]"),n=a.filter(":checked"),o=n.length,s=0,r=0;switch(t.ids=[],a.prop("disabled",!1),$(t.selectors.discount).parent().show(),$(t.selectors.totalPrice).parent().show(),$(t.selectors.totalPriceWithDiscount).parent().css({color:""}),o){case 1:n.prop("disabled",!0),$(t.selectors.discount).parent().hide(),$(t.selectors.totalPrice).parent().hide(),$(t.selectors.totalPriceWithDiscount).parent().css({color:"#000"});break;case 2:r=$(t.selectors.discount2).data("discount2");break;case 3:r=$(t.selectors.discount3).data("discount3");break;case 4:r=$(t.selectors.discount4).data("discount4")}i.each(function(){var e=$(this);(a=e.find("[type=checkbox]")).is(":checked")&&(s+=parseInt(e.find(t.selectors.price).html()),t.ids.push(e.attr(t.selectors.item.replace(/[\[\]]/g,""))))}),e=Math.floor(s-s*r/100),$(t.selectors.totalPrice).html(s),$(t.selectors.discount).html(r),$(t.selectors.totalPriceWithDiscount).html(e)},_e_changePriceBySize:function(e){var t=$(e.currentTarget),i=t.val(),a=t.attr(this.selectors.priceBySize.replace(/[\[\]]/g,""));t.addClass("_active").siblings().removeClass("_active").end().closest(this.selectors.item).attr(this.selectors.item.replace(/[\[\]]/g,""),i).find(this.selectors.price).html(a),this._calcTotalPrice()},_e_calcTotalPrice:function(e){var t=$(e.currentTarget);this._calcTotalPrice(),t.find("[type=checkbox]").is(":disabled")&&app.utils.notify("Комплект должен содержать хотя бы одно изделие")},_e_submitData:function(e){e.preventDefault();var t=this,i=$(e.currentTarget).data("url"),a={action:"complect-add",ids:t.ids};t.$el.addClass("_disabled"),$.post(i,a,function(e){"ok"===e.status?(t._addToBasket(t.ids.length),app.utils.notify(e.mess)):_.isUndefined(e.mess)?app.utils.notify("Неизвестная ошибка. Обратитесь к администрации."):app.utils.notify("Сервер вернул ошибку: <br> status = "+e.status+". <br> mess = "+e.mess+".",3e3)},"json").error(function(e,t,i){app.utils.notify("Ошибка запроса. <br> status = "+t+". <br> errorThrown = "+i+".",3e3)}).complete(function(){t.$el.removeClass("_disabled")})},_addToBasket:function(e){var t=$("[data-basket-cnt-only]"),i=parseInt(t.html());e=parseInt(e),t.html(i+e).closest(".header__bascket").addClass("_not-empty")}});t.el=e}(),app.views.GlobalView=Backbone.View.extend({oldViews:[],currentView:null,loader:null,menuItems:null,catalogMenu:null,mapLoaded:!1,initialize:function(){this.loader=app.components.loader,this.menuItems=$("[data-head-menu-item]"),this.catalogMenu=$("[data-catalog-menu]").closest(".menu__droplink"),this.initFluid()},selectCurrentMenu:function(e){var t=e;this.menuItems.removeClass("_active");for(var i=0;i<t.length;i++)this.menuItems.filter('[data-head-menu-item="'+t[i]+'"]').addClass("_active")},toggleCatalogMenu:function(e){"_active"==e?this.catalogMenu.addClass("_active _always-open"):this.hideCatalogMenu()},hideCatalogMenu:function(e){this.catalogMenu.removeClass("_active _always-open")},show:function(e){e.render(),this.currentView=e},hide:function(){var e=this;app.once("View.goOutDefaultStart",function(){e.loader.show()}),e.currentView.goOutDefault()},setTitle:function(e){$("title").html(e)},initFluid:function(){var e=1440,t=10,i=null;function a(){app.utils.isDesktop?app.Size.width<1250-app.utils.scrollWidth()?(i=(1250-app.utils.scrollWidth())/e,app.dom.$html.addClass("desktop-thin")):(i=Math.min(app.dom.$window.width(),e)/e,app.dom.$html.removeClass("desktop-thin")):(app.utils.isMobile?e=320:app.utils.isTablet&&(e=1024),i=e>1024?Math.min(app.dom.$window.width(),e)/e:app.dom.$window.width()/e),app.dom.$html.css({"display":"block","font-size":i*t+"px"})}a(),app.dom.$window.on("resize orientationchange",a)}}),app.views.Header=Backbone.View.extend({el:".header",mobMenuOpen:!1,subView:{},events:{"click [data-tooltip-btn]":"e_toggleTooltip"},initialize:function(){},render:function(){app.views.Header.__super__.render.apply(this,arguments);var e=this;e.initForm(),e.chosen(),e.initScrollMenu(),e.changeCity(),e.popups(),e.initBaseForm(),e.desktopActiveClass(),this.$("[data-mask-phone]").mask("+7 (999) 999-99-99"),this.$("input[type=checkbox], input[type=radio]").idealRadioCheck(),app.utils.isMobile||e.fixedMenu(),app.utils.isDesktop&&e.initDecktopeMenu(),app.utils.isTablet&&(e.initTabletMenu2(),e.initSearchTablet()),app.utils.isMobile&&(e.mobMenu(),e.mobPopups(),e.mobPhoneForm()),app.utils.getData||(app.utils.getData=app.utils.parseUrlQuery(window.location.search)),app.utils.getData.LOCATION,window.cache&&$.post("/personal/header.php",{LOCATION:app.utils.getData.LOCATION},function(t){e.$("[data-wish-cnt]").text(t.cntd+" "+t.textd),e.$("[data-basket-cnt]").text(t.basket),e.$("[data-wish-cnt-only]").text(t.cntd),e.$("[data-basket-cnt-only]").text(parseInt(t.basket)),e.checkEmptiness(e.$(".header__wish"),t.cntd),e.checkEmptiness(e.$(".header__bascket"),t.basket),t.user_r&&e.$("[data-scroll-menu-user]").html(t.user_r),t.user&&e.$(".header__profil-cont").html(t.user)},"json")},desktopActiveClass:function(){$(".menu__items [data-head-menu-item1]").each(function(){var e=$(this);~location.href.indexOf(e.attr("href"))&&e.addClass("_active"),e.on("click",function(e){$(".menu__items [data-head-menu-item1]._active").removeClass("_active"),$(e.currentTarget).addClass("_active")})})},removeActiveClass:function(){},checkEmptiness:function(e,t){parseInt(t)>0?e.addClass("_not-empty"):e.removeClass("_not-empty")},initDecktopeMenu:function(){var e=this.$(".droblink__inner"),t=this.$(".droblink__inner-inner"),i=this.$("[data-megamenu-main]"),a=this.$("[data-megamenu-special]"),n=null,o=null,s=null,r=null,l=null,d=function(){clearTimeout(l),l=setTimeout(function(){Boolean($(".droblink__inner._active").length)||i.removeClass("_active")},400)};app.dom.$window.on("scroll.desktopMenu",_.throttle(function(){0===$(this).scrollTop()&&setTimeout(function(){$("[data-fixed-menu]").find(".megamenu").removeClass("_active")},300)},300)),$(".menu__item._dropdown").hover(function(e){var t=this;e.stopPropagation(),clearTimeout(n),$(this).closest(".menu__droplink").prev("[data-megamenu-main]").hasClass("_active")?clearTimeout(l):(e.preventDefault(),o=setTimeout(function(){a.removeClass("_active"),$(t).closest(".menu__droplink").prev("[data-megamenu-main]").addClass("_active")},300))},function(){clearTimeout(o),d(),n=setTimeout(function(){$(this).closest(".menu__droplink").prev("[data-megamenu-main]").removeClass("_active"),i.removeClass("_active"),e.removeClass("_active")},300)}),i.hover(function(e){e.stopPropagation(),clearTimeout(n),$(this).hasClass("_active")||(e.preventDefault(),a.removeClass("_active"),$(this).addClass("_active"))},function(){n=setTimeout(function(){$(this).removeClass("_active"),i.removeClass("_active")},300)}),$("[data-menu-item]").hover(function(e){var t=this;e.stopPropagation(),clearTimeout(s),$("[data-menu-item] .menu__item._active").removeClass("_active"),$(this).find(".menu__item").addClass("_active"),$(this).find("[data-megamenu-special]").hasClass("_active")||(e.preventDefault(),r=setTimeout(function(){i.removeClass("_active"),a.removeClass("_active"),$(t).find("[data-megamenu-special]").addClass("_active")},300))},function(){clearTimeout(r),s=setTimeout(function(){a.removeClass("_active")},300)}),e.each(function(){var t=$(this),i=null;t.hover(function(){clearTimeout(i),i=setTimeout(function(){if(!t.hasClass("_active"))return e.removeClass("_active"),t.addClass("_active"),!1},300)},function(){clearTimeout(i),d()})}),t.each(function(){var e=$(this),i=null;e.hover(function(){if(clearTimeout(i),!e.hasClass("_active"))return t.removeClass("_active"),e.addClass("_active"),!1},function(){i=setTimeout(function(){e.removeClass("_active")},300)})})},initTabletMenu:function(){this.$("[data-catalog-menu]");var e=this.$(".droblink__inner"),t=this.$(".droblink__inner-inner"),i=this.$(".menu__droplink");function a(){i.hasClass("_always-open")||i.removeClass("_active"),e.removeClass("_active"),t.removeClass("_active")}e.click(function(){var t=$(this);if(!t.hasClass("_active"))return e.removeClass("_active"),t.addClass("_active"),!1}),t.click(function(){var e=$(this);if(!e.hasClass("_active"))return t.removeClass("_active"),e.addClass("_active"),!1}),i.click(function(){var e=$(this);if(!e.hasClass("_active"))return e.addClass("_active"),!1}),app.on("View.goOutDefaultStart",function(){a()},this),app.dom.$document.on("touchstart",function(e){$(e.target).closest(i).length||a()})},initTabletMenu2:function(){var e=this.$("[data-megamenu-main]"),t=this.$("[data-megamenu-special]");$(".menu__item._dropdown").click(function(i){i.preventDefault();var a=$(i.currentTarget).closest(".menu").find("[data-megamenu-main]");t.removeClass("_active"),a.hasClass("_active")?e.removeClass("_active"):a.addClass("_active")}),$("[data-head-menu-item1]").click(function(e){var t=$(e.currentTarget);t.next(".droplist__inner").length&&(e.preventDefault(),t.parent().addClass("_active").siblings().removeClass("_active"))}),$("[data-menu-item]").click(function(t){if(!$(t.target).hasClass("megamenu__link")){t.preventDefault();var i=$(t.currentTarget),a=i.prevAll("[data-menu-item]").length,n=$(".menu__items").find("[data-megamenu-special]"),o=i.closest(".menu").find(".menu__items").find("[data-menu-item]").eq(a).find("[data-megamenu-special]");e.removeClass("_active"),o.hasClass("_active")?o.removeClass("_active"):(n.removeClass("_active"),o.addClass("_active"))}})},initSearchTablet:function(){this.$("[data-toggle-search]").on("click",function(){$(this).closest("[data-form]").toggleClass("_active")})},hideSearchTablet:function(){this.$("[data-toggle-search]").closest("[data-form]").removeClass("_active")},initForm:function(){this.$("[data-form]").each(function(){var e=null,t=$(this),i=t.find("[data-chosen]");(e=t.find('input[type="text"]')).focus(function(){$(this).addClass("_focus")}),e.blur(function(){""==$(this).val()&&$(this).removeClass("_focus")}),i.change(function(){t.attr("action",$(this).val())})})},chosen:function(){app.utils.isTablet||this.$("[data-chosen]").chosen({disable_search_threshold:1e3,max_selected_options:3,width:"100%"})},setBasketCnt:function(e,t){this.$("[data-basket-cnt]").text(e+" "+t),$("[data-basket-cnt-only]").text(e),this.checkEmptiness(this.$(".header__bascket"),e)},setWishCnt:function(e,t){this.$("[data-wish-cnt]").text(e+" "+t),$("[data-wish-cnt-only]").text(e),this.checkEmptiness(this.$(".header__wish"),e)},fixedMenu:function(e){var t=this.$("[data-menu]"),i=this.$("[data-fixed-menu]");app.dom.$window.on("scroll",function(){app.dom.$window.scrollTop()>t.offset().top?i.addClass("_open"):i.removeClass("_open")})},changeCity:function(){var e=this.$("[data-city-field]"),t=this.$("[data-form-city]");e.on("change",function(){t.submit()})},popups:function(){var e=this,t=e.$("[data-popup]"),i=e.$("[data-popup-show]"),a=null;(i=i.add(app.Footer.$el.find("[data-popup-show]"))).on("click",function(){var i=$(this),n=t.filter('[data-popup="'+i.data("popupShow")+'"]');n.is("[data-popup-ajax]")?$.post(n.data("popupAjax"),{},function(t){a=$(t),$.fancybox({wrapCSS:"fc-base _popups",content:a,fitToView:!1,padding:0,helpers:{overlay:{css:{background:"rgba(0, 0, 0, 0.7)"}}},afterShow:function(){e.authForm(this),e.regForm(this),e.askForm(this)}})}):(a=n,$.fancybox({wrapCSS:"fc-base _popups",content:a,fitToView:!1,padding:0,helpers:{overlay:{css:{background:"rgba(0, 0, 0, 0.7)"}}},afterShow:function(){e.authForm(this),e.regForm(this),e.askForm(this)}}))})},authForm:function(e){var t=e.content,i=t.find("[data-auth-form]");i.length&&(t.find("input[type=checkbox], input[type=radio]").idealRadioCheck(),t.on("submit","[data-auth-form]",function(){return i=t.find("[data-auth-form]"),$.post(i.attr("action"),i.serialize(),function(e){e.redirect?window.location.href=e.redirect:(t.html(e.content),t.find("input[type=checkbox], input[type=radio]").idealRadioCheck())},"json"),!1}))},mobPhoneForm:function(){var e=this.$("[data-header-mob-phone-form]"),t=e.find("form"),i=e.find("[form-success]");t.submit(function(){return $.post(t.attr("action"),t.serialize(),function(e){e.success,t.hide(),i.fadeIn()},"json"),!1})},regForm:function(e){var t=e.content,i=t.find("[data-reg-form]");i.length&&(t.find("input[type=checkbox], input[type=radio]").idealRadioCheck(),t.on("submit","[data-reg-form]",function(){return i=t.find("[data-reg-form]"),$.post(i.attr("action"),i.serialize(),function(e){t.html(e.content),t.find("input[type=checkbox], input[type=radio]").idealRadioCheck(),e.redirect&&(window.location.href=e.redirect)},"json"),!1}))},askForm:function(e){var t=this,i=e.content,a=i.find("[data-ask-form]"),n=i.find("[data-ask-form-success]");a.length&&(t.initBaseForm(a),i.find("[data-mask-phone]").mask("+7 (999) 999-99-99"),a.show(),n.hide(),i.on("submit","[data-ask-form]",function(){return a=i.find("[data-ask-form]"),n=i.find("[data-ask-form-success]"),$.post(a.attr("action"),a.serialize(),function(e){i.html(e.content),t.initBaseForm(i.find("[data-base-form]")),i.find("[data-mask-phone]").mask("+7 (999) 999-99-99")},"json"),!1}))},mobMenu:function(){var e=this,t=e.$("[data-mob-menu-btn]"),i=e.$("[data-mob-menu]"),a=e.$("[data-menu]"),n=i.find("[data-mob-menu-close]"),o=$("body").find(".grid"),s=$(".header").outerHeight(),r=0;function l(){$("body, html").removeClass("overflow-hidden"),o.css({y:0}),$("html, body").scrollTop(r),t.removeClass("_active"),setTimeout(function(){t.removeClass("_active"),i.removeClass("_show"),e.mobMenuOpen=!1},100)}function d(){app.dom.$document.scrollTop()>s?a.addClass("_hide"):a.removeClass("_hide")}t.on("click",function(){$(this).hasClass("_active")?l():(e.mobMenuOpen=!0,r=app.dom.$window.scrollTop(),o.css({y:-r}),t.addClass("_active"),$("body, html").addClass("overflow-hidden"),setTimeout(function(){t.addClass("_active"),i.addClass("_show")},100))}),n.on("click",function(){l()}),app.on("View.goOutDefaultStart",function(){l()},e),$(".mob-menu__items [data-head-menu-item1]").on("click.mobMenu",function(e){var t=$(e.currentTarget);t.next(".droplist__inner").length&&(e.preventDefault(),t.parent().toggleClass("_active"))}),d(),app.dom.$window.on("scroll.mobMenuScroll",d)},mobPopups:function(){var e=this.$("[data-header-mob-popup]"),t=this.$("[data-header-mob-popup-show]");function i(){e.hide(),t.removeClass("_active")}t.on("click",function(){var t=$(this),a=e.filter('[data-header-mob-popup="'+t.data("headerMobPopupShow")+'"]');$(this).hasClass("_active")?function(e,t){t.removeClass("_active"),e.hide()}(a,t):(i(),function(e,t){t.addClass("_active"),e.show()}(a,t))}),e.on("click",function(e){$(e.target).closest(".mob-popup__content").length||i()}),app.on("closeMobPopups",function(){i()},this),app.on("View.goOutDefaultStart",function(){i()},this),app.dom.$window.off("keydown.mobPopups"),app.dom.$window.on("keydown.mobPopups",function(e){if(27===e.keyCode)return i(),!1})},initScrollMenu:function(){var e=this.$("[data-scroll-menu]"),t=(e.find("[data-scroll-menu-search]"),e.find("[data-scroll-menu-search-toggle]")),i=e.find("[data-scroll-menu-search-form]");t.on("click",function(){$(this).toggleClass("_active"),i.toggleClass("_active")})},showScrollMenu:function(){this.$("[data-scroll-menu]").show()},hideScrollMenu:function(){this.$("[data-scroll-menu]").hide()},initBaseForm:function(e){e||(e=this.$("[data-base-form]"));var t=e.find("[data-form-field]"),i=e.find("[data-form-field-inp]");i.focus(function(){$(this).addClass("_focus").closest(t).removeClass("_error")}),i.blur(function(){""==$(this).val()&&$(this).removeClass("_focus")})},e_toggleTooltip:function(e){var t=$(e.currentTarget).closest(".tooltip"),i=t.find("[data-tooltip]");t.hasClass("is-open")?(t.removeClass("is-open"),i.hide()):(t.addClass("is-open"),i.show())}}),app.views.Footer=Backbone.View.extend({el:".footer",render:function(){app.views.Footer.__super__.render.apply(this,arguments);this.initSubscription(),this.initForceDesktop()},initForceDesktop:function(){var e=this.$("[data-force-desktop]"),t=this.$("[data-force-desktop-off]");e.click(function(){setCookie("site_viewType","isDesktop",{path:"/"}),setCookie("forseDesktop",!0,{path:"/"}),window.location.reload()}),t.click(function(){deleteCookie("site_viewType"),deleteCookie("forseDesktop"),window.location.reload()})},initSubscription:function(){var e=this.$("[data-subscription-form]"),t=e.find('input[type="email"]'),i=e.find("[data-subscription-form-inner]"),a=e.find("[data-subscription-form-errors]"),n=e.find("[data-subscription-form-success]");e.submit(function(){return $.post(e.attr("action"),e.serialize(),function(e){""!=e.errors?a.text(e.errors).show():(a.hide(),i.hide(),n.fadeIn())},"json"),!1}),t.focus(function(){$(this).addClass("_focus")}),t.blur(function(){""==$(this).val()&&$(this).removeClass("_focus")})}}),app.views.Default=Backbone.View.extend({loader:null,popup:null,html:null,needGoIn:!1,className:null,pageHolder:null,subView:{},$bigGallery:null,defLoadAllImages:null,defGoIn:null,defLoaderHide:null,defaultLoaderHide:!0,remove:function(){var e=this;e.trigger("remove"),e.off(),app.off(null,null,e),_.each(e.subView,function(t,i){app.off(null,null,t),t.remove(),delete e.subView[i]}),e.subView=null,app.views.Default.__super__.remove.apply(e,arguments)},initialize:function(){this.loader=app.components.loader,app.on("checkGetParams",this.checkGetParams,this)},setProps:function(e,t){this.html=e,this.className=t},render:function(){this.loader.hide(),app.dom.$window.scrollTop(0),this.html?(app.GlobalView.$el.append(this.html),this.setElement(app.GlobalView.$el.find('[data-view="'+this.className+'"]')),app.trigger("dom.append"),this.needGoIn&&this.goIn()):this.goIn()},afterRender:function(){this.checkGetParams(),this.chosen(),this.addToBasket(),this.buyProduct(),this.delayProduct(),this.detailPopup(),this.changeProductSize2(),this.initNav(),this.popups(),this.initBaseForm(),this.availabilityPopup(),this.watchlivewhatsappPopup(),this.share(),this.initAnimation(),this.$("input[type=checkbox]:not(.md-checkbox__input), input[type=radio]:not(.md-radio__input)").idealRadioCheck(),this.initMaterialFields(),this.initMaskPhone(),this.rangeSliders(),this.closeDetailPopup(),this.initCard(),app.utils.isTablet&&app.Header.hideSearchTablet(),app.utils.isMobile&&this.initMobileCatalogClick(),$("[data-slider-image]").each(function(e,t){$(t).data("slider-image")&&"false"!==$(t).data("slider-image")&&$(t).addClass("is-loading")}),this.lazyLoadImages(),this.initChooseJewelry(),this.reinitAfterBitrixAjax(),this.formValidation()},reinitAfterBitrixAjax:function(){var e=this;void 0!==window.BX&&BX.addCustomEvent("onAjaxSuccess",function(){e.chosen(),e.initBaseForm(),e.initMaterialFields(),e.initMaskPhone($("[data-popup]")),$(".friend-popup").length&&e.subView.FriendPopup.render(),e.formValidation()})},initMobileCatalogClick:function(){app.dom.$html.find(".card__ref").on("click","a",function(e){var t=$(this),i=t.parent().parent().parent().parent().hasClass("_active");t.is("[data-product-btn]")&&(window.location.href=t.attr("href")),i||e.preventDefault()})},initMaskPhone:function(e){var t=this.$el;e&&(t=e),t.find("[data-mask-phone]").each(function(){var e=$(this),t=""==e.data("maskPhone")?"+7 (999) 999-99-99":e.data("maskPhone");e.mask(t)})},share:function(){this.$(".my-share").each(function(){try{Ya.share2(this)}catch(e){}})},checkGetParams:function(){if(app.utils.getData||(app.utils.getData=app.utils.parseUrlQuery(window.location.search)),app.utils.getData.goto){var e=$(app.utils.getData.goto);e.length&&(app.Router._pageCounter?t():$(window).load(t))}function t(){setTimeout(function(){$("html, body").stop(!0,!0).animate({scrollTop:e.offset().top-app.Header.$el.find("[data-fixed-menu]").height()-20},500)},310)}},goOutDefault:function(){var e=this;app.trigger("View.goOutDefaultStart"),setTimeout(function(){e.remove(),app.trigger("View.goOutDefaultEnd")},300)},goIn:function(){app.trigger("View.goIn")},initGoto:function(){this.$el.on("click","[data-goto]",function(e){e.preventDefault(),$("html, body").animate({scrollTop:$($(this).data("goto")).offset().top-app.Header.$el.find("[data-fixed-menu]").height()-20},500)})},chosen:function(){app.utils.isTablet||$("[data-chosen]").chosen({disable_search_threshold:1e3,max_selected_options:3,width:"100%"})},initAnimation:function(){var e=this.$("[data-animation]"),t=null,i=null,a=_.throttle(function(){t=app.dom.$document.scrollTop(),i=app.Size.height,e.each(function(){var e=$(this);e.offset().top-t<=i&&e.addClass("_active")})},100);app.dom.$window.scroll(a),t=app.dom.$document.scrollTop(),i=app.Size.height,e.each(function(){var e=$(this);e.offset().top-t-50<=i&&e.addClass("_active")})},initSwiperTape:function(){new Swiper("[data-swiper-tape-container]",{autoplay:!1,loop:!1,freeMode:!0,centeredSlides:!1,simulateTouch:!0,slidesPerView:"auto"})},initSwiperCollect:function(){var e=this;new Swiper("[data-gal-collect-container]",{nextButton:"[data-next-collect]",prevButton:"[data-prev-collect]",autoplay:8e3,loop:!0,slidesPerView:"auto",spaceBetween:0,freeMode:!1,simulateTouch:!1,onInit:function(e){var t=app.dom.$html.css("font-size").replace("px",""),i=$(e.slides).find(".collect__info"),a=[];i.each(function(){a.push($(this).outerHeight(!0))}),i.css("height",_.max(a)/t+"rem")},onSlideChangeStart:function(t){e.loadSlideCollect(t.slides,t.activeIndex,t)}})},initSwiperRecommend:function(){var e=this;new Swiper("[data-gal-recommend-container]",{autoplay:4e3,loop:!0,freeMode:!1,centeredSlides:!0,simulateTouch:!1,paginationClickable:!0,pagination:"[data-gal-recommend-pagination]",onSlideChangeStart:function(t){e.loadSlideImgDiv(t.slides,t.activeIndex,t,!1,".recommend-gal__image.m-dn"),e.loadSlideImgDiv(t.slides,t.activeIndex,t,!1,".recommend-gal__image.d-dn.t-dn")}})},initSwiperBrands:function(){var e;e=device.mobile()?2:device.tablet()?4:6;new Swiper("[data-gal-brands-container]",{nextButton:"[data-next-brands]",prevButton:"[data-prev-brands]",autoplay:6e3,loop:!0,slidesPerView:e,spaceBetween:0,freeMode:!1,simulateTouch:!1})},initSwiperSmall:function(){var e,t;device.tablet()?(e=5,t=15):(e=6,t=26);new Swiper("[data-gal-small-container]",{nextButton:"[data-next-small]",prevButton:"[data-prev-small]",loop:!0,slidesPerView:e,spaceBetween:t,freeMode:!1,simulateTouch:!1})},initSwiperSmall2:function(){var e,t;device.tablet()?(e=5,t=15):(e=6,t=26);new Swiper("[data-gal-small2-container]",{nextButton:"[data-next-small2]",prevButton:"[data-prev-small2]",autoplay:4e3,autoplayDisableOnInteraction:!0,loop:!0,slidesPerView:e,spaceBetween:t,freeMode:!1,simulateTouch:!1})},initSwiperBanner:function(){var e=this;if(Modernizr.flexbox)new Swiper("[data-gal-banner]",{loop:!0,autoplay:6e3,autoplayDisableOnInteraction:!0,pagination:"[data-gal-banner-pagination]",paginationClickable:!0,freeMode:!1,centeredSlides:!0,simulateTouch:!1,nextButton:"[data-gal-banner-next]",prevButton:"[data-gal-banner-prev]",onSlideChangeStart:function(t){e.loadSlideImg(t.slides,t.activeIndex,t)}});else this.$("[data-gal-banner]").remove()},loadSlideCollect:function(e,t,i,a){var n=$(e[t]).children(".collect__image"),o=n.data("slider-image"),s=this;1===t&&i.stopAutoplay(),o&&"false"!==o&&$("<img/>").attr("src",o).on("load",function(){$(this).remove(),n.attr("style","background-image: url('"+o+"')"),n.attr("data-slider-image","false"),n.removeData("slider-image"),n.data("slider-loaded","true"),n.removeClass("is-loading"),a&&i.startAutoplay(),e[t+1]&&s.loadSlideCollect(e,t+1,i,!0)})},loadSlideImg:function(e,t,i,a){var n=$(e[t]).children("a"),o=n.data("slider-image"),s=this;1===t&&i.stopAutoplay(),o&&"false"!==o&&$("<img/>").attr("src",o).on("load",function(){$(this).remove(),n.attr("style","background-image: url('"+o+"')"),n.attr("data-slider-image","false"),n.removeData("slider-image"),n.data("slider-loaded","true"),n.removeClass("is-loading"),a&&i.startAutoplay(),e[t+1]&&s.loadSlideImg(e,t+1,i,!0)})},loadSlideImgDiv:function(e,t,i,a,n){var o=$(e[t]).children(n),s=o.data("slider-image"),r=this;1===t&&i.stopAutoplay(),s&&"false"!==s&&$("<img/>").attr("src",s).on("load",function(){$(this).remove(),o.attr("style","background-image: url('"+s+"')"),o.attr("data-slider-image","false"),o.removeData("slider-image"),o.data("slider-loaded","true"),o.removeClass("is-loading"),a&&i.startAutoplay(),e[t+1]&&r.loadSlideImgDiv(e,t+1,i,!0)})},initNav:function(){$("html").off("click.nav"),$("html").on("click.nav","[data-nav-btn]",function(){$(this).toggleClass("_active").closest("[data-nav-block]").find("[data-nav-content]").slideToggle(500)})},initCard:function(){$("html").off("click.card"),$("html").on("click.card",".card",function(e){var t=$(this);if(app.utils.isMobile||app.utils.isTablet)if(t.hasClass("_active"))t.removeClass("_active");else if($(".card").removeClass("_active"),$(e.target).closest("[data-product-form-success]").length||t.addClass("_active"),"A"==e.target.tagName&&!$(e.target).closest("[data-product-form-success]").length)return!1}),$("html").off("click.cardClose"),$("html").on("click.cardClose",function(e){$(e.target).closest(".card").length||$(".card").removeClass("_active")})},

availabilityPopup:function(){function e(){$("[data-availability-popup]").fadeOut(),$("html").off("click.availabilityPopupClose")}$("html").off("click.availabilityPopupShow"),$("html").on("click.availabilityPopupShow","[data-availability-popup-show]",function(){$("[data-availability-popup]").fadeIn(),$("html").off("click.availabilityPopupClose"),$("html").on("click.availabilityPopupClose",function(t){$(t.target).closest("[data-availability-popup-close]").length&&e(),$(t.target).closest("[data-availability-popup]").length||e()})}),app.dom.$window.off("keydown.availabilityPopup"),app.dom.$window.on("keydown.availabilityPopup",function(t){if(27===t.keyCode)return e(),!1})},

watchlivewhatsappPopup:function(){function e(){$("[data-watchlivewhatsapp-popup]").fadeOut(),$("html").off("click.watchlivewhatsappPopupClose")}$("html").off("click.watchlivewhatsappPopupShow"),$("html").on("click.watchlivewhatsappPopupShow","[data-watchlivewhatsapp-popup-show]",function(){$("[data-watchlivewhatsapp-popup]").fadeIn(),$("html").off("click.watchlivewhatsappPopupClose"),$("html").on("click.watchlivewhatsappPopupClose",function(t){$(t.target).closest("[data-watchlivewhatsapp-popup-close]").length&&e(),$(t.target).closest("[data-watchlivewhatsapp-popup]").length||e()})}),app.dom.$window.off("keydown.watchlivewhatsappPopup"),app.dom.$window.on("keydown.watchlivewhatsappPopup",function(t){if(27===t.keyCode)return e(),!1})},

initBaseForm:function(e){e||(e=this.$("[data-base-form]"));var t=e.find("[data-form-field]"),i=e.find("[data-form-field-inp]");i.focus(function(){$(this).addClass("_focus").closest(t).removeClass("_error")}),i.blur(function(){""==$(this).val()&&$(this).removeClass("_focus")})},initMaterialFields:function(){var e=$("[data-md-field] input, [data-md-field] textarea, [data-md-field] select");e.each(function(){""!=$(this).val()&&$(this).closest("[data-md-field]").addClass("_focus"),"phone"===$(this).closest("[data-md-field]").data("mdField")&&$(this).mask("+7 (999) 999-99-99")}),e.focus(function(){$(this).closest("[data-md-field]").addClass("_focus")}),e.blur(function(){""==$(this).val()&&$(this).closest("[data-md-field]").removeClass("_focus")}),app.utils.isDesktop&&e.filter("select").chosen({disable_search_threshold:1e3,max_selected_options:3,width:"100%",placeholder_text_single:" "}),e.filter("select").change(function(e){var t=$(e.target),i=t.closest("select"),a=t.closest("[data-md-field]");""==i.val()?a.removeClass("_focus"):a.addClass("_focus")})},popups:function(){var e=this,t=null;app.dom.$document.off(".popups").on("click.popups","[data-popup-show]",function(){var i=$(this).data("popupShow");t=$('[data-popup="'+i+'"]'),$.fancybox({wrapCSS:"fc-base _popups",content:t,fitToView:!1,padding:0,helpers:{overlay:{css:{background:"rgba(0, 0, 0, 0.7)"}}},afterShow:function(){app.trigger("popupShow"+i,this),t.find("[data-issue-map]").length&&(e.subView.IssueMap.render(i),app.dom.$body.addClass("_issue-map-is-opened")),t.is(".friend-popup")&&e.subView.FriendPopup.render(),e.initMaskPhone(t),e.formValidation(),e.initMaterialFields(),e.initBaseForm(),e.chosen(),app.trigger("formOrderSalon")},afterClose:function(){app.dom.$body.hasClass("_issue-map-is-opened")&&app.dom.$body.removeClass("_issue-map-is-opened")}})})},addToBasket:function(){var e=this;$("html").off("click.addToBasket"),$("html").on("click.addToBasket","[data-add-to-basket]",function(t){var i=$(this);"1"==i.data("addToBasket")&&(t.preventDefault(),$.post(i.attr("href"),{},function(t){app.Header.setBasketCnt(t.cnt,t.products),app.Header.checkEmptiness(e.$(".header__bascket"),t.cnt),i.data("addToBasket",0).text(t.text).removeAttr("data-not-ajax").attr("href",t.href),i.data("rel")&&window.location.replace(i.data("rel"))},"json"))})},buyProduct:function(){var e=$("html");e.off("click.buyProduct"),e.off("submit.buyProduct"),e.on("click.buyProduct","[data-product-basket-btn]",function(){var e=$(this),t=e.closest("[data-product]").data("product");e.data("productBasketBtn")?$.post(e.data("productBasketBtn"),{priductId:t},function(t){e.closest("[data-product]").find("[data-product-form-success]").addClass("_active"),app.Header.setBasketCnt(t.cnt,t.products)},"json"):e.closest("[data-product]").find("[data-product-size]").toggleClass("_active")}),e.on("click.buyProduct","[data-product-buy]",function(){$(this).closest("[data-product]").find("[data-product-size]").toggleClass("_active")}),e.on("click.buyProduct","[data-product-del]",function(){var e=$(this);e.hide("_active"),$.get(e.attr("rel"),function(){})}),e.on("submit.buyProduct","[data-product-form]",function(){var e=$(this);return $.post(e.attr("action"),e.serialize(),function(t){e.closest("[data-product]").find("[data-product-form-success]").addClass("_active"),app.Header.setBasketCnt(t.cnt,t.products)},"json"),!1})},delayProduct:function(){var e=this,t=$("html");t.off("click.delayProduct"),t.on("click.delayProduct","[data-product-delay-btn]",function(){var t=$(this);$.post(t.data("productDelayBtn"),{},function(i){t.toggleClass("_active"),app.Header.setWishCnt(i.cntd,i.textd),app.Header.checkEmptiness(e.$(".header__wish"),i.cntd)},"json")})},detailPopup:function(){var e=this,t=$("html"),i=$("[data-detail-popup]"),a=i.find("[data-detail-popup-close]"),n=i.find("[data-detail-popup-content]"),o=$("body"),s=0;function r(){o.removeClass("_overflow-h"),o.css("top","auto"),setTimeout(function(){$("html, body").animate({scrollTop:s},10)},10),i.fadeOut(500)}t.off("click.detailPopup"),t.on("click.detailPopup","[data-product-btn]",function(t){t.preventDefault();var a=$(this).closest("[data-product]").data("product");$.post($(this).data("url"),{id:a},function(t){n.html(t.content),e.initMaskPhone(n),app.utils.isTablet||n.find("[data-chosen]").chosen({disable_search_threshold:1e3,max_selected_options:3,width:"100%"}),s=app.dom.$window.scrollTop(),o.css("top",-s),o.addClass("_overflow-h"),i.fadeIn(500),app.utils.isMobile||CloudZoom.quickStart();var a=n.find("[data-detail-img-btn]");a.on("click",function(){var e=$(this);a.removeClass("_selected"),e.addClass("_selected")}),n.find(".my-share").each(function(){Ya.share2(this)}),e.popups()},"json")}),a.on("click",function(){r()}),i.off("click.detailPopupClose"),i.on("click.detailPopupClose",function(e){$(e.target).closest(a).length&&r(),$(e.target).closest(n).length||r()}),app.dom.$window.off("keydown.detailPopup"),app.dom.$window.on("keydown.detailPopup",function(e){if(27===e.keyCode)return r(),!1})},closeDetailPopup:function(){var e=$("[data-detail-popup]");$("body").removeClass("_overflow-h"),e.fadeOut(500)},changeProductSize2:function(){var e=this.$("[data-detail-prop]"),t=this.$("[data-detail-article]"),i=this.$("[data-detail-price]");app.dom.$document.off(".changeProductSize"),app.dom.$document.on("click.changeProductSize","[data-detail-size-field]",function(a){var n,o=$(this),s=$(a.target).closest("[data-detail-size-btn]"),r=o.closest("[data-detail-ajax-part]"),l=o.closest("[data-detail-product]").data("detailProduct");s.addClass("_active").siblings().removeClass("_active"),o.closest("[data-detail-popup]").length||(n=window.location.pathname+"?"+s.attr("name")+"="+s.val(),app.Router.navigate(n,{trigger:!1})),$.post(r.data("url"),{id:l,val:s.val()},function(a){r.html(a.content),e.each(function(){$(this).html(a.props[$(this).attr("id")])}),i.html(a.price),t.html(a.article)},"json")})},startAjasReload:function(e){e.closest("[data-ajax-reload]").addClass("ajax-repoad");setTimeout(function() {e.closest("[data-ajax-reload]").removeClass("ajax-repoad")}, 2000);},stopAjasReload:function(e){e.closest("[data-ajax-reload]").removeClass("ajax-repoad"),window.card_addimgnav&&card_addimgnav()},discountsForm:function(){var e=this.$("[data-discounts-form]"),t=(e.find("[data-discounts-form-field]"),e.find("[data-discounts-form-errors]")),i=e.find("[data-discounts-form-success]");i.hide(),t.hide(),e.submit(function(){return $.post(e.attr("action"),e.serialize(),function(e){""!=e.errors?(t.text(e.errors).show(),i.hide()):(i.show(),t.hide())},"json"),!1})},tabs:function(e){var t=e.find("[data-tab-btn]"),i=e.find("[data-tab-content]"),a=null;t.on("click",function(){var e=$(this);e.hasClass("_active")||(a=e.data("tabBtn"),t.removeClass("_active").filter("[data-tab-btn="+a+"]").addClass("_active"),i.slideUp(300).filter("[data-tab-content="+a+"]").slideDown(300))})},rangeSliders:function(){this.$("[data-range-slider-wrap]").each(function(){var e=$(this),t=e.find("[data-range-slider]"),i=e.find("[data-inp-from]"),a=e.find("[data-inp-to]"),n=t.data("rangeSlider"),o=null,s=null,r=null;t.slider({range:!0,min:n.min,max:n.max,step:n.step,values:[n.valueFrom||n.min,n.valueTo||n.max],slide:function(e,t){i.val(t.values[0]),a.val(t.values[1])},start:function(e,t){r=t.values[0],s=t.values[1]},stop:function(e,t){t.values[0]!=r&&i.val(t.values[0]).change(),t.values[1]!=s&&a.val(t.values[1]).change()}}),i.val(t.slider("values",0)),a.val(t.slider("values",1)),i.on("change",function(){o=Math.max(Math.min(t.slider("values",1),i.val()),n.min),t.slider("values",[o,t.slider("values",1)]),i.val(o)}),a.on("change",function(){o=Math.min(Math.max(t.slider("values",0),a.val()),n.max),t.slider("values",[t.slider("values",0),o]),a.val(o)})})},lazyLoadImages:function(){function e(e,t,i,a){e.is("img")?(e.parent().css({position:"relative"}).append('<div class="img-loader is-loading"></div>'),e.attr("src",t).load(function(){e.removeClass("is-loading"),e.next(".img-loader").removeClass("is-loading"),e.parent().children(".img-loader").removeClass("is-loading")}).error(function(){$(this).attr("src","static/theme/images/no_photo_240.jpg"),e.next(".img-loader").removeClass("is-loading")})):$("<img />").attr("src",t).load(function(){$(this).remove(),e.css({backgroundImage:"url("+t+")"}),i&&i()}).error(function(){$(this).remove(),e.css({backgroundImage:"url(static/theme/images/no_photo_240.jpg)"}),a&&a()})}this.$("[data-image]").each(function(){var t=$(this);t.waypoint(function(){if("none"===t.css("display"))return!1;var i=t.data("image");t.addClass("is-loading"),e(t,i,function(){t.removeClass("is-loading")},function(){t.removeClass("is-loading")});var a=t.find("[data-inner-image]");device.desktop()&&a.length&&a.each(function(){var t=$(this),i=t.data("innerImage");e(t,i)}),this.destroy()},{offset:"100%"})})},initChooseJewelry:function(){var e=$("[data-cj]");e.length&&($.cookie("BANNER_CLOSED")&&e.remove(),e.on("click",function(t){$(t.target).is("[data-cj-close]")&&(e.remove(),$.cookie("BANNER_CLOSED","Y",{expires:365,path:"/"}))}))},formValidation:function(e,t){(e=e||$("[data-validate]")).each(function(){($(this).closest("form").length?$(this).closest("form"):$(this).find("form")).on("click.FormValidation","[type=submit]",function(e){e.preventDefault();var i=$(e.currentTarget).closest("form"),a=!1,n=$('<div class="errortext"/>'),o={required:[]},s={required:"Не заполнены следующие обязательные поля:"};if(i.find(".errortext").remove(),i.find("input:visible, textarea:visible").each(function(){var e=$(this);e.is("[data-required]")&&""==e.val()&&(e.siblings(".md-field__hint").length?o.required.push(e.siblings(".md-field__hint").text()):o.required.push(e.attr("name")))}),_.map(o,function(e,t){if(e.length>0||!0===e){a=!0;var i=_.isArray(o[t])?"- "+o[t].join("<br> - "):"<br>";n.append(s[t]+"<br>"+i+"<br><br>")}else a=!1}),a)i.prepend(n);else if(t)t(e);else if(i.data("form-order-salon"))if(app.on("formOrderSalon",function(){i.show(),i.siblings("[data-order-ajax-mess]").remove()}),i[0].reportValidity()){if("true"!==i.data("form-ajax-processing")){i.data("form-ajax-processing","true");var r=new FormData(i.get(0));$.ajax({url:i.attr("action"),type:"POST",data:r,cache:!1,processData:!1,contentType:!1,beforeSend:function(){i.addClass("_disabled"),i.data("form-ajax-processing","true")},success:function(e,t,a){if("ok"===e.status){var o=$("<div data-order-ajax-mess />");i.siblings("[data-order-ajax-mess]").remove(),i.parent().append(o.html(e.mess)),i.find("input, textarea").each(function(){$(this).val("")}),i.hide()}else i.removeClass("_disabled"),_.isUndefined(e.mess)?i.prepend(n.append("Неизвестная ошибка. Обратитесь к администрации.")):i.prepend(n.append(e.mess))},error:function(e,t,a){i.prepend(n.append("Ошибка AJAX запроса. Обратитесь к администрации."))},complete:function(){i.removeClass("_disabled").data("form-ajax-processing","")}})}}else i[0].reportValidity();else i.submit()})})}}),app.views.NotFound=app.views.Default.extend({remove:function(){app.views.NotFound.__super__.remove.apply(this,arguments)},render:function(){app.views.NotFound.__super__.render.apply(this,arguments)}}),app.views.Home=app.views.Default.extend({events:{},initialize:function(){app.views.Home.__super__.initialize.apply(this,arguments)},remove:function(){app.views.Home.__super__.remove.apply(this,arguments),app.Header.showScrollMenu()},render:function(){app.views.Home.__super__.render.apply(this,arguments);this.initSwiperCollect(),this.initSwiperRecommend(),this.initSwiperBrands(),this.initSwiperBanner(),this.gemsGall(),this.historyGall(),this.initSubscription(),this.card(),app.Header.hideScrollMenu(),app.views.Home.__super__.afterRender.apply(this,arguments)},card:function(){var e=this.$("[data-home-card]"),t=e.find("[data-home-card-form]"),i=e.find("[data-home-card-check]"),a=e.find("[data-home-card-result]"),n=e.find("[data-home-card-percent]"),o=e.find("[data-home-card-error]"),s=e.find("[data-home-card-back]"),r=e.find("[data-home-card-sum]");t.submit(function(){return $.post(t.attr("action"),t.serialize(),function(e){e?(i.hide(),o.hide(),a.show(),n.html(e.UF_PERCENT),r.html(e.UF_SUM)):o.show()},"json"),!1}),s.on("click",function(){a.hide(),i.show()})},gemsGall:function(){this.$("[data-gems-gall]").each(function(){var e=$(this);new Swiper(e[0],{loop:!0,slidesPerView:1,nextButton:e.find("[data-gems-gall-next]"),prevButton:e.find("[data-gems-gall-prev]")})})},historyGall:function(){this.$("[data-history-gall]").each(function(){var e=$(this),t=e.find("[data-history-gall-pag-item]"),i=null,a=new Swiper(e[0],{freeMode:!1,loop:!0,slidesPerView:1,onSlideChangeStart:function(e){(i=e.activeIndex)>t.length&&(i=1),0==i&&(i=t.length),t.removeClass("_active").eq(i-1).addClass("_active")}});t.on("click",function(){var e=$(this);e.hasClass("_active")||(t.removeClass("_active"),e.addClass("_active"),a.slideTo(e.index()+1))})})},initSubscription:function(){var e=this.$("[data-subscription-form]"),t=e.find('input[type="email"]'),i=e.find("[data-subscription-form-inner]"),a=e.find("[data-subscription-form-errors]"),n=e.find("[data-subscription-form-success]");e.submit(function(){return $.post(e.attr("action"),e.serialize(),function(e){""!=e.errors?a.text(e.errors).show():(a.hide(),i.hide(),n.fadeIn())},"json"),!1}),t.focus(function(){$(this).addClass("_focus")}),t.blur(function(){""==$(this).val()&&$(this).removeClass("_focus")})}}),app.views.Catalog=app.views.Default.extend({masonry1:null,$addMoreBlock:null,$pagination:null,$catalogItems:null,events:{},subView:{MiniGall:new app.subViews.MiniGall,IssueMap:new app.subViews.IssueMap,FriendPopup:new app.subViews.FriendPopup},initialize:function(){app.views.Catalog.__super__.initialize.apply(this,arguments)},remove:function(){this.$el.off("click.Catalog.addMore"),app.dom.$body.removeClass("catalog-page"),app.views.Catalog.__super__.remove.apply(this,arguments)},render:function(){app.views.Catalog.__super__.render.apply(this,arguments);if(app.dom.$body.addClass("catalog-page"),this.$addMoreBlock=this.$("[data-catalog-add-more-block]"),this.$pagination=this.$("[data-catalog-pagination]"),this.$catalogItems=this.$("[data-catalog-items]"),this.initSwiperTape(),this.initSizeCard(),this.initFilter(),this.initStickyFilters(),this.initFiltersScroll(),this.discountsForm(),this.addMore(),this.subView.MiniGall.render(".card__img"),!app.Router._pageCounter){var e=Backbone.history.fragment||"./";app.Router.navigate(e+window.location.search,{trigger:!1})}this.detailMap=!0,app.views.Catalog.__super__.afterRender.apply(this,arguments)},initSizeCard:function(){if(app.utils.isTablet)return!1;function e(){$(".card._big").css({width:2*parseInt($(".card:not(._big)").first().css("width")),height:2*parseInt($(".card:not(._big)").first().css("height"))})}e(),app.off("resize",e,this).on("resize",e,this)},initFilter:function(){var e=this,t=e.$("[data-filter]"),i=e.$("[data-filter-reset]"),a=e.$("[data-filter-counter]"),n=t.find("[data-filter-form]"),o=t.find("[data-filter-block]"),s=t.find("[ data-filter-block-title]"),r=t.find("[data-filter-block-content]"),l=e.$("[data-catalog-pagination]"),d=e.$("[data-catalog-items]"),c=null,p=e.$("[data-catalog-block]"),u=e.$("[data-filter-toggle-btn]"),f=e.$("[data-filter-products-btn]"),h=e.$("[data-sort-field]"),m=e.$("[data-sort-filtr-field]"),v=t.find("[data-filter-more]"),g=t.find("[data-filter-more-btn]"),w=null,b=t.find("[data-filter-option]"),y=t.find("[data-inp-from],[data-inp-to]"),k=t.find("[data-filter-selection-option-template]"),C=e.$(".tagz");function x(){function e(){var e=$(".catalog__main-right").offset().top-app.Size.height;app.dom.$window.scrollTop()<e?f.show():f.hide()}app.utils.isMobile&&($("._close-filter").length?(e(),app.dom.$window.on("scroll.inviewFilter",_.throttle(function(){e()},300))):app.dom.$window.off(".inviewFilter"))}h.on("change",function(){m.val(h.val()),n.submit()}),y.on("change",function(){n.submit()}),e.masonry1=d.masonry({itemSelector:".card",columnWidth:".card:not(._big)"}),s.on("click",function(){$(this).toggleClass("_active").closest(o).find(r).slideToggle(400,function(){setTimeout(function(){e.initStickyFilters(),e.initFiltersScroll()},500),x()})}),u.on("click",function(){if($(this).toggleClass("_active"),p.toggleClass("_close-filter"),i.toggle(),app.utils.isMobile||e.masonry1.masonry("layout"),app.utils.isMobile){var t=app.utils.isMobilePort?app.Header.$el.find("[data-fixed-menu]").height():0;e.$(".catalog__top-right").toggle(),$("html, body").animate({scrollTop:$(".catalog__filter").offset().top-t-60},500)}app.utils.isMobilePort&&(f.toggle(),x())}),f.on("click",function(){if(device.mobile()||device.portrait()){var e=$(".catalog__main-right").offset().top,t=app.Header.$el.find("[data-fixed-menu]").height(),i=$(".catalog__top").height();$("html, body").animate({scrollTop:e-t-i},500,function(){u.removeClass("_active"),p.removeClass("_close-filter"),f.hide(),x()})}}),g.on("click",function(){var e=$(this);e.toggleClass("_active").closest(o).find(v).slideToggle(),w=e.hasClass("_active")?"Скрыть":"Показать ещё",e.text(w)}),b.on("change",function(){var e=$(this),t=e.data("filterOption");if(n.submit(),e.is(":checked")?k.clone().appendTo(C).removeClass("hide").removeAttr("data-filter-selection-option-template").attr("data-filter-selection-option",t.id).find("[data-filter-selection-option-text]").text(t.title):C.find("[data-filter-selection-option]").each(function(){var e=$(this);e.data("filterSelectionOption")==t.id&&e.remove()}),C.find("[data-filter-selection-option]").length?i.addClass("_show"):i.removeClass("_show"),!device.mobile()){var a=$(".catalog__main-right").offset().top,o=device.tablet()?0:app.Header.$el.find("[data-fixed-menu]").height();$("html, body").animate({scrollTop:a-o},500)}}),C.on("click","[data-filter-selection-option]",function(){var e=$(this);b.each(function(){var t=$(this);t.data("filterOption").id==e.data("filterSelectionOption")&&t.click()})}),n.submit(function(){return c=n.serialize(),e.startAjasReload(e.$catalogItems),$.get(n.attr("action"),n.serialize(),function(t){if(c==n.serialize()){if(l.html(t.pag),0===parseInt(t.cnt))d.html('<div class="empty-search">По Вашему запросу изделий не найдено.</div>'),d.css("height","auto");else{var i=$(t.content);d.masonry("remove",d.find(".card")).html(i),e.initSizeCard(),d.masonry("appended",i).masonry("layout")}a.html(t.cnt),_.each(t.filtr_arr,function(e){_.each(e,function(e,t){e?(n.find('label[data-id="'+t+'"]').show(),n.find('input[value="'+t+'"]').siblings("[data-filter-element-count]").html("("+e+")")):(n.find('label[data-id="'+t+'"]').hide(),n.find('input[value="'+t+'"]').siblings("[data-filter-element-count]").html(""))})}),e.updateScripts(t),e.updatePagination(t.more,t.pag)}},"json"),app.utils.isMobile&&$(".catalog__top-right").toggle(),!1})},addMore:function(){var e=this;e.$el.on("click.Catalog.addMore","[data-catalog-add-more]",function(t){var i=$(this);t.preventDefault(),e.startAjasReload(e.$catalogItems),$.post(i.attr("href"),{},function(t){var i=$(t.content);e.$catalogItems.append(i),e.initSizeCard(),e.$catalogItems.masonry("appended",i),e.updateScripts(t),e.updatePagination(t.more,t.pag)},"json")}),e.$el.on("click.Catalog.addMore","[data-catalog-pagination-item]",function(t){var i=$(this);t.preventDefault(),e.startAjasReload(e.$catalogItems),$.post(i.attr("href"),{},function(t){var i=$(t.content);e.$catalogItems.masonry("remove",e.$catalogItems.find(".card")).html(i),e.initSizeCard(),e.$catalogItems.masonry("appended",i).masonry("layout"),e.updateScripts(t),e.updatePagination(t.more,t.pag)},"json");var a=$(".catalog__main-right").offset().top,n=device.tablet()?0:app.Header.$el.find("[data-fixed-menu]").height(),o=device.mobile()?$(".catalog__top").height():0;$("html, body").animate({scrollTop:a-n-o},500)})},updateScripts:function(e){this.share(),this.chosen(),app.Router.navigate(e.cururl,{trigger:!1}),this.stopAjasReload(this.$catalogItems)},updatePagination:function(e,t){var i=this;i.$addMoreBlock.html(e),i.$pagination.html(t),i.subView.MiniGall.render(".card__img"),setTimeout(function(){i.lazyLoadImages(),i.initStickyFilters(),i.initFiltersScroll()},500)},initFiltersScroll:function(){var e=$("[data-flexcroll]");e.length&&e[0].scrollHeight-e[0].clientHeight>0&&fleXenv.fleXcrollMain(e[0])},initStickyFilters:function(){var e="[data-sticky-container]";if(!device.mobile()&&$(e).length){var t=void 0,i=device.tablet()?0:$("[data-fixed-menu]").outerHeight()+"px";void 0===t?a():t.updateSticky(),app.dom.$window.on("scroll",_.throttle(function(){t.updateSticky()},300)),this.listenTo(app,"resize",function(){t.destroy(),setTimeout(a,300)})}function a(){t=new StickySidebar(e,{innerWrapperSelector:"[data-sticky]",topSpacing:i,bottomSpacing:0})}}}),app.views.Page1=app.views.Default.extend({events:{},initialize:function(){app.views.Page1.__super__.initialize.apply(this,arguments)},remove:function(){app.views.Page1.__super__.remove.apply(this,arguments)},render:function(){app.views.Page1.__super__.render.apply(this,arguments);app.views.Page1.__super__.afterRender.apply(this,arguments)}}),app.views.Detail=app.views.Default.extend({$addMoreBlock:null,$pagination:null,$catalogItems:null,events:{},subView:{FriendPopup:new app.subViews.FriendPopup,IssueMap:new app.subViews.IssueMap,ProductsGall:new app.subViews.ProductsGall,SetGall:new app.subViews.SetGall,MiniGall:new app.subViews.MiniGall},files:[],initialize:function(){app.views.Detail.__super__.initialize.apply(this,arguments)},remove:function(){app.dom.$document.off(".openAction"),app.views.Detail.__super__.remove.apply(this,arguments)},render:function(){app.views.Detail.__super__.render.apply(this,arguments);this.subView.ProductsGall.render(),this.subView.SetGall.render(),this.subView.MiniGall.render(".card__img"),this.discountsForm(),this.photosGall(),this.Viewed(),this.initFancybox(),this.initGoto(),this.$addMoreBlock=this.$("[data-catalog-add-more-block]"),this.$pagination=this.$("[data-catalog-pagination]"),this.$catalogItems=this.$("[data-catalog-items]"),this.initReverseAnin(),this.addReviews(),this.rateReview(),this.addMore(),this.openAction(),this.detailMap=!0,app.views.Detail.__super__.afterRender.apply(this,arguments)},Viewed:function(){var e=this.$("[data-detail-viewed]");$.get(e.data("detail-viewed"))},photosGall:function(){var e=this.$("[data-detail-img-btn]");CloudZoom.quickStart(),e.on("click",function(){var t=$(this);e.removeClass("_selected"),t.addClass("_selected")})},setBlockHeight:function(){var e=this.$("[data-detail-block]"),t=e.find("[data-detail-block-left]"),i=e.find("[data-detail-block-right]");function a(){i.css("min-height",t.outerHeight())}a(),app.on("resize",a)},initFancybox:function(){this.$("[data-fancy]").fancybox({wrapCSS:"fc-base b-review__gallery",loop:!1,afterShow:function(){var e=$(this.element[0]),t=$(".b-review__gallery");e.is("._video")?t.addClass("_video"):t.removeClass("_video"),t.on("click.detailFancy",".fancybox-nav",function(){var e=t.find("video");e.length&&e[0].play()&&e[0].pause()})},beforeClose:function(){var e=$(this.element[0]),t=$(".b-review__gallery");if(e.is("._video")){var i=t.find("video");i.length&&i[0].play()&&i[0].pause()}t.off(".detailFancy")}})},initReverseAnin:function(){this.$("[data-reverse-anim]").hover(function(){},function(){var e=$(this);e.addClass("_reverse-anim"),setTimeout(function(){e.removeClass("_reverse-anim")},800)})},rateReview:function(){var e=$("[data-usefull-url]"),t=e.data("usefullUrl");e.on("click","[data-review-rate]",function(e){var i=$(this),a=i.find("[data-review-count]"),n=parseInt(a.text()),o=i.closest("[data-review-id]").data("reviewId"),s=i.data("reviewRate"),r={id:o,review:s};$.cookie("VOTE_REVIEW_"+o)?app.utils.notify("Вы уже проголосовали за этот отзыв."):$.post(t,r,function(e){"ok"===e.status?($.cookie("VOTE_REVIEW_"+o,"Y",{expires:365,path:"/"}),a.html(n+1)):app.utils.notify("Ошибка сервера. <br> status = "+e.status+". <br> mess = "+e.mess+".")},"json")})},addReviews:function(){var e=this;function t(t){t.find("[type=submit]").html("Загрузка...");var a=new FormData(t.get(0));$.each(e.files,function(e,t){a.append("files["+e+"]",t,t.name)}),$.ajax({url:t.attr("action"),type:"POST",data:a,cache:!1,processData:!1,contentType:!1,beforeSend:function(){t.addClass("_disabled")},xhr:function(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",function(e){if(e.lengthComputable){var i=Math.round(100*e.loaded/e.total);t.find("[type=submit]").html("Загрузка: "+i+"%")}},!1),e},success:function(e,i,a){var n=$("<div data-ask-ajax-mess />");t.siblings("[data-ask-ajax-mess]").remove(),t.find("[type=submit]").prop("disabled",!0).html("Загрузка завершена"),"ok"===e.status?t.parent().append(n.html(e.mess)):t.parent().append(n.html("Ошибка сервера. <br> status = "+e.status+". <br> mess = "+e.mess+"."))},error:function(e,t,i){alert("ОШИБКА AJAX запроса: "+t,e,i)},complete:function(){t.removeClass("_disabled").hide(),t.find("input, textarea").each(function(){var e=$(this);e.is("[name=review_add]")||e.val("")}),i(t).clear(),e.previewFiles(t).clear()}})}function i(e){var t=e.find("[data-rating-select]"),i=t.find("a"),a=e.find("[data-rating-inp]");return i.hover(function(){var e=$(this).index();t.removeClass("_1 _2 _3 _4 _5").addClass("_"+(e+1)),a.val(e+1)}),{clear:function(){t.removeClass("_1 _2 _3 _4 _5")}}}app.on("popupShowreviews",function(e){var a=e.content,n=a.find("form");this.initBaseForm(a.find("form")),i(a.find("form")),n.length&&(n.show(),n.siblings("[data-ask-ajax-mess]").remove(),n.find("[type=submit]").prop("disabled",!1).html("Отправить"),this.previewFiles(n),n.on("submit",function(e){e.preventDefault()}),n.on("click","[type=submit]",function(e){e.preventDefault(),(n=a.find("form")).find(".errortext").remove();var i=!1,o=$('<div class="errortext"/>'),s={required:[]},r={required:"Не заполнены следующие обязательные поля:"};if(n.find("input, textarea").each(function(){var e=$(this);e.is("[data-required]")&&""==e.val()?"rating"===e.data("required")?s.required.push("Рейтинг*"):s.required.push(e.siblings(".md-field__hint").text()):e.is("[name=g-recaptcha-response]")&&""==e.val()&&s.required.push("Я не робот*")}),_.map(s,function(e,t){if(e.length>0||!1===e){i=!0;var a=_.isArray(s[t])?"- "+s[t].join("<br> - "):"<br>";o.append(r[t]+"<br>"+a+"<br><br>")}else i=!1}),i)return e.preventDefault(),n.prepend(o),n.closest(".fancybox-overlay").animate({scrollTop:0}),!1;n.get(0).reportValidity()?t(n):n.get(0).reportValidity()}))},e)},previewFiles:function(e){var t=this,i=e.find("[data-file-preview-list]"),a=e.find("[data-file-btn]"),n={image:["jpg","jpeg","png","gif"],video:["mp4","mov"]},o=new RegExp("(\\.|/)("+n.image.join("|")+")$","i"),s=new RegExp("(\\.|/)("+n.video.join("|")+")$","i"),r="."+n.image.join(",.")+",."+n.video.join(",.");function l(e,t){e>=t?a.addClass("_disabled"):a.removeClass("_disabled")}return e.find("[type=file]").attr("accept",r),e.off(".previewFiles"),e.on("change.previewFiles","[type=file]",function(e){var a=$(this).get(0).files,n=a.length;if(n+i.children().length>3)return alert("Пожалуйста, выберите не более 3 файлов.");for(var r=0;r<n;r++){var d=function(e,a){var n=$("<"+e+"/>").attr("src",window.URL.createObjectURL(a)).load(function(){window.URL.revokeObjectURL(this.src)}),o=$('<div class="b-form__preview-item" />').append(n).wrapInner('<div class="b-form__preview-thumb"></div>').append('<div class="b-form__preview-name">'+a.name+"</div>").prepend('<div class="b-form__preview-del" data-file-del>Удалить &times;</div>');i.append(o),t.files.push(a),l(i.children().length,3)},c=a[r];c.size>1e8?alert("Размер файла "+c.name+" больше 100 мб!"):c.name.match(o)?d("img",c):c.name.match(s)?d("video",c):alert("Файл "+c.name+" не поддерживается")}}),e.on("click.previewFiles","[data-file-del]",function(){for(var e=$(this),a=e.siblings(".b-form__preview-name").text(),n=void 0,o=0;o<t.files.length;o++)t.files[o].name==a&&(n=o);t.files.splice(n,1),e.parent().remove(),l(i.children().length,3)}),{clear:function(){t.files=[],i.html(""),e.off(".previewFiles"),a.removeClass("_disabled")}}},addMore:function(){var e=this;e.$el.on("click.Reviews.addMore","[data-catalog-add-more]",function(t){var i=$(this).attr("href");t.preventDefault(),e.startAjasReload(e.$catalogItems),i.length?$.post(i,{},function(t){t.list&&e.$catalogItems.append(t.list),t.btnUrl?$("[data-catalog-add-more]").attr("href",t.btnUrl):$("[data-catalog-add-more]").hide(),e.updateScripts(t)},"json"):$("[data-catalog-add-more]").hide()})},updateScripts:function(e){this.popups(),this.stopAjasReload(this.$catalogItems)},openAction:function(){if(device.desktop())return!1;app.dom.$document.on("touchend.openAction",function(e){var t=$(e.target).closest("[data-action-opener]"),i=t.find("[data-action-box]");if(!t)return!1;setTimeout(function(){return i.show()},300),e.stopPropagation()})}}),app.views.Wishlist=app.views.Default.extend({events:{},initialize:function(){app.views.Wishlist.__super__.initialize.apply(this,arguments)},remove:function(){app.views.Wishlist.__super__.remove.apply(this,arguments)},render:function(){app.views.Wishlist.__super__.render.apply(this,arguments);this.initSwiperWishlist(),this.initForm(),app.views.Wishlist.__super__.afterRender.apply(this,arguments)},initForm:function(){var e=this.$("[data-form]"),t=null;(t=e.find('input[type="text"]')).focus(function(){$(this).addClass("_focus")}),t.blur(function(){""==$(this).val()&&$(this).removeClass("_focus")})},initSwiperWishlist:function(){var e,t,i,a,n=this.$("[data-gal-wishlist]"),o=$("[data-img-wishlist]");device.tablet()?(e=3,t=40,a=!1):device.mobile()?(e=1,t=0,i=".swiper-pagination",a=!0):(e=4,t=70,a=!1);var s=new Swiper("[data-gal-wishlist]",{nextButton:"[data-next-wishlist]",prevButton:"[data-prev-wishlist]",loop:!0,slidesPerView:e,spaceBetween:t,freeMode:!1,pagination:i,paginationClickable:a,simulateTouch:!0,paginationBulletRender:function(e,t){return'<span class="'+t+'" style="background-image: url('+app.utils.getBackgroundImageUrl(o.eq(e))+'); background-size: contain;"></span>'}});n.on("click","[data-product-del]",function(){var e=$(this);s.removeSlide(e.closest("[data-swiper-slide-index]").data("swiperSlideIndex"))})}}),app.views.Account=app.views.Default.extend({events:{},subView:{ProductsGall:new app.subViews.ProductsGall},initialize:function(){app.views.Account.__super__.initialize.apply(this,arguments)},remove:function(){app.views.Account.__super__.remove.apply(this,arguments)},render:function(){app.views.Account.__super__.render.apply(this,arguments);this.delBlock(),this.maskedPhone(),this.mobSlide(),this.profile(),this.initSwiperWishlist(),this.initLoadFiles(),this.addAddress(),this.subView.ProductsGall.render(),app.views.Account.__super__.afterRender.apply(this,arguments)},addAddress:function(){var e=this;e.$("[data-popup]").each(function(){app.on("popupShow"+$(this).data("popup"),function(e){var t=this,i=e.content,a=i.find("form");t.initBaseForm(i.find("form")),a.length&&i.on("submit","form",function(){return a=i.find("form"),$.post(a.attr("action"),a.serialize(),function(e){e.redirect?window.location.href=e.redirect:(i.html(e.body),t.initBaseForm(i.find("form")),i.find("input[type=checkbox], input[type=radio]").idealRadioCheck())},"json"),!1})},e)})},profile:function(){var e=this.$("[data-form-profile]"),t=e.find("[data-form-field]"),i=e.find("[data-form-field-inp]"),a=this.$("[data-form-email]"),n=this.$("[data-account-discont]");a.submit(function(){var e=$(this),t=e.serialize(),i=e.find("[data-form-profile-btn]"),a=e.find("[data-form-field]"),n=e.find("[data-form-field-inp]");return i.removeClass("_ok").addClass("_dots"),$.post(e.attr("action"),t,function(e){e.errors&&(!0,_.each(e.errors,function(e,t){n.filter('[name="'+t+'"]').closest(a).addClass("_error")})),i.removeClass("_dots").addClass("_ok"),setTimeout(function(){i.removeClass("_ok")},1e3)},"json"),!1}),e.submit(function(){var a=e.serialize(),o=e.find("[data-form-profile-btn]");return o.removeClass("_ok").addClass("_dots"),$.post(e.attr("action"),a,function(e){e.errors&&(!0,_.each(e.errors,function(e,a){i.filter('[name="'+a+'"]').siblings(".b-form__field-error").text(e).closest(t).addClass("_error")})),o.removeClass("_dots").addClass("_ok"),setTimeout(function(){o.removeClass("_ok")},1e3),n.html(e.card_html)},"json"),!1})},initSwiperWishlist:function(){var e,t,i,a,n=this.$("[data-gal-wishlist]"),o=$("[data-img-wishlist]");device.tablet()?(e=3,t=40,a=!1):device.mobile()?(e=1,t=0,i=".swiper-pagination",a=!0):(e=4,t=70,a=!1);var s=new Swiper("[data-gal-wishlist]",{nextButton:"[data-next-wishlist]",prevButton:"[data-prev-wishlist]",loop:!1,slidesPerView:e,spaceBetween:t,freeMode:!1,pagination:i,paginationClickable:a,simulateTouch:!0,paginationBulletRender:function(e,t){return'<span class="'+t+'" style="background-image: url('+app.utils.getBackgroundImageUrl(o.eq(e))+'); background-size: contain;"></span>'}});n.on("click","[data-product-del]",function(){var e=$(this);s.removeSlide(e.closest("[data-swiper-slide-index]").data("swiperSlideIndex"))})},bigGallery:function(){var e=this.$("[data-gallery]"),t=this.$("[data-gallery-prev]"),i=this.$("[data-gallery-next]");e.carouFredSel({circular:!1,infinite:!1,responsive:!0,auto:!1,align:"center",items:{visible:4},swipe:{onTouch:!0,onMouse:!0},prev:t,next:i})},delBlock:function(){var e=this.$("[data-del-wrap]"),t=this.$("[data-del-content]"),i=this.$("[data-del-btn]");e.each(function(){var e=this;$(e).find(i).on("click",function(){var i=$(this).closest("form").serialize();$.post($(this).attr("rel"),i,function(){$(e).find(t).fadeOut()})})})},maskedPhone:function(){this.$("[data-masked-phone]").mask("(999) 999-9999")},mobSlide:function(){var e=this.$("[data-container]"),t=this.$("[data-inner]"),i=this.$("[data-call-slide]"),a=this.$("[data-arr]"),n=1;e.each(function(){var e=this;$(e).find(i).on("click",function(){$(e).find(t).slideToggle(),0==n?($(e).find(a).css({transform:"rotate(180deg)"}),n=1):($(e).find(a).css({transform:"rotate(0deg)"}),n=0)})})},initLoadFiles:function(){var e=this.$("[data-file]");e.each(function(){var e=$(this);e.fileupload({dropZone:e,url:"/server/php/",dataType:"json",done:function(t,i){$.each(i.result.files,function(t,i){e.css("backgroundImage","url("+i.url+")")})}}).prop("disabled",!$.support.fileInput).parent().addClass($.support.fileInput?void 0:"disabled")})}}),app.views.Collections=app.views.Default.extend({events:{},initialize:function(){app.views.Collections.__super__.initialize.apply(this,arguments)},remove:function(){app.views.Collections.__super__.remove.apply(this,arguments)},render:function(){app.views.Collections.__super__.render.apply(this,arguments);this.gemsGall(),app.views.Collections.__super__.afterRender.apply(this,arguments)},gemsGall:function(){new Swiper("[data-gems-gall]",{loop:!0,slidesPerView:1,nextButton:"[data-gems-gall-next]",prevButton:"[data-gems-gall-prev]"})}}),app.views.Shopping=app.views.Default.extend({events:{},subView:{IssueMap:new app.subViews.IssueMap},initialize:function(){app.views.Shopping.__super__.initialize.apply(this,arguments)},remove:function(){$(".grid").removeClass("_ofv"),app.Header.showScrollMenu(),app.views.Shopping.__super__.remove.apply(this,arguments)},render:function(){app.views.Shopping.__super__.render.apply(this,arguments);this.initBasket(),this.initDelivery(),$(".grid").addClass("_ofv"),this.cartMap=!0,app.Header.hideScrollMenu(),app.views.Shopping.__super__.afterRender.apply(this,arguments)},ChangeContent:function(e){this.$el.html(e.content),app.Header.setBasketCnt(e.cnt,e.text),app.views.Shopping.__super__.afterRender.apply(this,arguments),this.initBasket(),this.initDelivery()},PostForm:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this,a=$(e).closest("[data-basket_form]");i.startAjasReload(i.$el);var n=a.serialize();if(t){for(var o=n.split("&"),s=[],r=0;r<o.length;r++)-1===o[r].indexOf("DELIVERY_ID")&&s.push(o[r]);n=s.join("&")}let data = {sessid: '',order: {},};a.serializeArray().forEach(function(elem) {switch (elem.name) {case 'sessid': data.sessid = elem.value; break;}data.order[elem.name] = elem.value;});$.post(a.attr("action"),n,function(e){i.ChangeContent(e),i.stopAjasReload(i.$el)},"json")},initBasket:function(){

		// ищем изделия бренда Груша
		var grusha_find = $(".shopping__item[data-brend-item='31469']").length;

		// ищем подарочные сертификаты
		var certificate_find = $(".shopping__item[data-stop-item='gift-certificate']").length;
		// if(grusha_find == 1){
		// $('.shopping__form-radio-23').css("display", "none");$('.shopping__form-radio-23').remove();
		// }

		// определяем текущую локацию
		var locationId = $.cookie('LOCATION');

		// если локация Москва и в корзине найдено изделие бренда Груша то убираем систему оплаты: Оплата онлайн и Сберспасибо
		if (locationId == 129 && grusha_find == 1) {
			$('.shopping__form-radio-15').css("display", "none");
			$('.shopping__form-radio-15').remove();
			$('.shopping__form-radio-20').css("display", "none");
			$('.shopping__form-radio-20').remove();
		}
		// если в корзине найден подарочный сертификат то убираем систему оплаты: рассрочка
		if (certificate_find == 1) {
			$('.shopping__form-radio-23').css("display", "none");
			$('.shopping__form-radio-23').remove();
		}

		// // определяем выбранную систему доставки, и выводим нужное пояснение
		// var delivery_checked_find = $('#ID_DELIVERY_ID_2:checked').length;
		// if (delivery_checked_find == 1) {
		// 	$('#arPaySystemOutputField').html('5% выгода при онлайн-оплате');//самовывоз
		// } else {
		// 	$('#arPaySystemOutputField').html('10% выгода при онлайн-оплате');//доставка
		// }

var e=this,t=e.$("[data-card-number]"),i=e.$("[data-coupon]"),a=e.$("[data-basket]"),n=e.$("[data-order-city]"),o=e.$("[data-shopping-delivery-method-btn]"),s=e.$("[data-profile]"),r=e.$("[data-submit-order]"),l=e.$("[data-basket-req]"),d=e.$("[name=PAY_SYSTEM_ID]"),c=null;d.on("change",function(){e.PostForm(this)}),$("#refresh").on("click",function(){e.PostForm(this)}),i.on("change",function(){e.PostForm(this)}),s.on("change",function(){e.PostForm(this)}),o.on("change",function(){e.PostForm(this)}),n.on("change",function(){e.PostForm(this,!0)}),t.on("change",function(){e.PostForm(this)}),a.on("change","[data-basket-item-count]",function(){e.PostForm(this)}),r.on("click",function(){var e=!1;if(l.length&&(l.each(function(){0==$(this).val()&&(e=!0)}),e))return alert("Заполните: ФИО Продавца, Предоплату, Дату доставки и Видеоконсультацию"),!1;$("#confirmorder").val("Y")}),$("#ORDER_PROP_22").on("change",function(){$("#ORDER_PROP_22_").hide(),"none"==$(this).val()&&$("#ORDER_PROP_22_").show()}),a.on("click","[data-basket-item-del]",function(){var t=$(this),i=t.closest("[data-basket-item]");c=i.data("basketItem"),e.startAjasReload(e.$el),i.hide(),$.get(t.closest("[data-basket_form]").attr("action"),{id:c,action:"delete"},function(t){e.ChangeContent(t),e.stopAjasReload(e.$el)},"json")})},initDelivery:function(){var e=this.$("[data-shopping-delivery]"),t=e.find("[data-metro-select]"),i=e.find("[data-metro-item]");function a(e){var t=null;t=i.filter('[data-metro-item="'+e+'"]'),i.hide(),t.show(),t.first().length&&t.first().find("input").click()}t.length&&a(t.val()),t.on("change",function(){a($(this).val())})}}),app.views.Contacts=app.views.Default.extend({myMap:null,events:{},initialize:function(){app.views.Contacts.__super__.initialize.apply(this,arguments)},remove:function(){this.myMap.destroy(),app.views.Contacts.__super__.remove.apply(this,arguments)},render:function(){app.views.Contacts.__super__.render.apply(this,arguments);var e=this;if(app.GlobalView.mapLoaded)e.cityMap();else{var t=document.createElement("script");t.type="text/javascript",t.src="https://api-maps.yandex.ru/2.1/?lang=ru_RU&onload=initialize",document.body.appendChild(t),window.initialize=function(){app.GlobalView.mapLoaded=!0,e.cityMap()}}e.cityTabs(),e.changeCity(),app.views.Contacts.__super__.afterRender.apply(this,arguments)},cityTabs:function(){var e=this.$("[data-city-tab]"),t=this.$("[data-city-content]"),i=(this.$("[data-shops-list]"),null);e.on("click",function(){var a=$(this);a.hasClass("_active")||(i=a.data("cityTab"),e.removeClass("_active"),t.slideUp(300).filter("[data-city-content="+i+"]").slideDown(300),a.addClass("_active"))})},changeCity:function(){this.$("[data-contacts-city-select]").on("change",function(){var e="/company/salons"+$(this).val();window.location=e})},cityMap:function(){var e,t=this,i=t.$("[data-city-map]"),a=i.data("xcoord"),n=i.data("ycoord"),o=t.$("[data-zoom-plus]"),s=t.$("[data-zoom-minus]"),r=t.$("[data-shops-list]"),l=r.find("[data-flexcroll]"),d=r.find("[data-shop]"),c=t.$("[data-filter]"),p=c.find("[data-filter-line]"),u=c.find("[data-filter-station]"),f=c.find("[data-filter-relation-line-station]"),h=null,m=[];function v(){d.hide();var t=e.searchIntersect(h).search(function(e){var t=f.filter(":visible").find(u);return!("all"!=p.val()&&!e.options.get("$dom").data("shop").lineIds[p.val()])&&("all"==t.val()||!!e.options.get("$dom").data("shop").stationIds[t.val()])}).addToMap(h).each(function(e){e.options.get("$dom").show()});e.remove(t).removeFromMap(h),setTimeout(function(){l[0].scrollHeight-l[0].clientHeight>0&&fleXenv.fleXcrollMain(l[0])},10)}ymaps.ready(function(){!function(){a||(a=d.first().data("shop").lan);n||(n=d.first().data("shop").lat);h=new ymaps.Map(i[0],{center:[n,a],zoom:10,autoFitToViewport:"always",controls:[]}),t.myMap=h,h.behaviors.disable(["scrollZoom"]);var o=new ymaps.control.SearchControl;h.controls.add(o,{position:{right:32,top:20}}),d.each(function(){var e=$(this),t=e.data("shop"),i=new ymaps.Placemark([t.lat,t.lan],{balloonContent:e.next("[data-balloon-content]").html()},{iconLayout:"default#image",iconImageHref:"/static/theme/images/icons/mark.png",iconImageSize:[44,57],iconImageOffset:[-22,-57],$dom:e});e.data("Placemark",i),m.push(i)}),e=ymaps.geoQuery(m),"none"!=c.css("display")?(v(),h.events.add("boundschange",function(){v()})):e.addToMap(h)}(),o.click(function(e){e.preventDefault(),h.setZoom(h.getZoom()+1)}),s.click(function(e){e.preventDefault(),h.setZoom(h.getZoom()-1)})}),p.on("change",function(){var e=$(this);f.hide().filter("[data-filter-relation-line-station='"+e.val()+"']").show(),v()}),u.on("change",function(){v()})}}),app.views.Gift=app.views.Default.extend({events:{},initialize:function(){app.views.Gift.__super__.initialize.apply(this,arguments)},remove:function(){app.views.Gift.__super__.remove.apply(this,arguments)},render:function(){app.views.Gift.__super__.render.apply(this,arguments);this.initSwiperGift(),this.initSubmit(),app.views.Gift.__super__.afterRender.apply(this,arguments)},initSubmit:function(){var e=this.$("[data-gift-search]");e.on("click",function(){e.closest("form").submit(),e.closest("form").find("select").each(function(){})})},initSwiperGift:function(){this.$("[data-gall-gift-wrap]").each(function(){var e=$(this),t=e.find("[data-gall-gift]")[0],i=e.find("[data-gall-gift-prev]"),a=e.find("[data-gall-gift-next]");new Swiper(t,{nextButton:a,prevButton:i,slidesPerView:4,spaceBetween:0,breakpoints:{640:{slidesPerView:2}}})})}}),app.views.Individual=app.views.Default.extend({events:{},initialize:function(){app.views.Individual.__super__.initialize.apply(this,arguments)},remove:function(){app.views.Individual.__super__.remove.apply(this,arguments)},render:function(){app.views.Individual.__super__.render.apply(this,arguments);this.initSwiperTrends(),this.initSwiperCollect(),this.bottomForm(),this.initFancybox(),this.initGoto(),app.views.Individual.__super__.afterRender.apply(this,arguments)},initFancybox:function(){this.$("[data-fancy]").fancybox({wrapCSS:"fc-base",loop:!1})},initSwiperTrends:function(){var e=this.$("[data-trends]"),t=e.find("[data-trends-gall]"),i=e.find("[data-trends-gall-prev]"),a=e.find("[data-trends-gall-next]"),n=e.find("[data-trends-text]");e.find("[data-trends-gall-item]"),new Swiper(t[0],{nextButton:a,prevButton:i,loop:!0,slidesPerView:5,centeredSlides:!0,initialSlide:-2,onSlideChangeStart:function(){n.text(t.find(".swiper-slide-active").data("text"))},onInit:function(){n.text(t.find(".swiper-slide-active").data("text"))},breakpoints:{640:{slidesPerView:1},1024:{slidesPerView:3}}})},bottomForm:function(){var e=this,t=e.$("[data-individual-bottom-form]"),i=e.$(".individual__feedback-form");t.submit(function(){var a=t.serialize();return $.post(t.attr("action"),a,function(t){i.html(t.body),e.initBaseForm(),i.find("[data-mask-phone]").mask("+7 (999) 999-99-99"),e.bottomForm()},"json"),!1})}}),app.views.Exclusive=app.views.Default.extend({events:{},initialize:function(){app.views.Exclusive.__super__.initialize.apply(this,arguments)},remove:function(){app.views.Exclusive.__super__.remove.apply(this,arguments)},render:function(){app.views.Exclusive.__super__.render.apply(this,arguments);this.initSwiperSwan(),this.initSwiperGrace(),this.initSwiperReality(),this.initSwiperStella(),this.initSwiperPearl(),this.initSwiperSeaGodness(),this.initFancybox(),this.initGoto(),app.views.Exclusive.__super__.afterRender.apply(this,arguments)},initFancybox:function(){this.$("[data-fancy]").fancybox({wrapCSS:"fc-base",loop:!1})},initSwiperSwan:function(){var e=this.$("[data-swan]"),t=e.find("[data-swan-gall]"),i=e.find("[data-swan-gall-prev]"),a=e.find("[data-swan-gall-next]"),n=e.find("[data-swan-text]");e.find("[data-swan-gall-item]"),new Swiper(t[0],{nextButton:a,prevButton:i,loop:!0,slidesPerView:5,centeredSlides:!0,initialSlide:-2,onSlideChangeStart:function(){n.text(t.find(".swiper-slide-active").data("text"))},onInit:function(){n.text(t.find(".swiper-slide-active").data("text"))},breakpoints:{640:{slidesPerView:1},1024:{slidesPerView:3}}})},initSwiperGrace:function(){var e=this.$("[data-grace]"),t=e.find("[data-grace-gall]"),i=e.find("[data-grace-gall-prev]"),a=e.find("[data-grace-gall-next]"),n=e.find("[data-grace-text]");e.find("[data-grace-gall-item]"),new Swiper(t[0],{nextButton:a,prevButton:i,loop:!0,slidesPerView:5,centeredSlides:!0,initialSlide:-2,onSlideChangeStart:function(){n.text(t.find(".swiper-slide-active").data("text"))},onInit:function(){n.text(t.find(".swiper-slide-active").data("text"))},breakpoints:{640:{slidesPerView:1},1024:{slidesPerView:3}}})},initSwiperReality:function(){var e=this.$("[data-reality]"),t=e.find("[data-reality-gall]"),i=e.find("[data-reality-gall-prev]"),a=e.find("[data-reality-gall-next]"),n=e.find("[data-reality-text]");e.find("[data-reality-gall-item]"),new Swiper(t[0],{nextButton:a,prevButton:i,loop:!0,slidesPerView:5,centeredSlides:!0,initialSlide:-2,onSlideChangeStart:function(){n.text(t.find(".swiper-slide-active").data("text"))},onInit:function(){n.text(t.find(".swiper-slide-active").data("text"))},breakpoints:{640:{slidesPerView:1},1024:{slidesPerView:3}}})},initSwiperStella:function(){var e=this.$("[data-stella]"),t=e.find("[data-stella-gall]"),i=e.find("[data-stella-gall-prev]"),a=e.find("[data-stella-gall-next]"),n=e.find("[data-stella-text]");e.find("[data-stella-gall-item]"),new Swiper(t[0],{nextButton:a,prevButton:i,loop:!0,slidesPerView:5,centeredSlides:!0,initialSlide:-2,onSlideChangeStart:function(){n.text(t.find(".swiper-slide-active").data("text"))},onInit:function(){n.text(t.find(".swiper-slide-active").data("text"))},breakpoints:{640:{slidesPerView:1},1024:{slidesPerView:3}}})},initSwiperPearl:function(){var e=this.$("[data-pearl]"),t=e.find("[data-pearl-gall]"),i=e.find("[data-pearl-gall-prev]"),a=e.find("[data-pearl-gall-next]"),n=e.find("[data-pearl-text]");e.find("[data-pearl-gall-item]"),new Swiper(t[0],{nextButton:a,prevButton:i,loop:!0,slidesPerView:5,centeredSlides:!0,initialSlide:-2,onSlideChangeStart:function(){n.text(t.find(".swiper-slide-active").data("text"))},onInit:function(){n.text(t.find(".swiper-slide-active").data("text"))},breakpoints:{640:{slidesPerView:1},1024:{slidesPerView:3}}})},initSwiperSeaGodness:function(){var e=this.$("[data-seagodness]"),t=e.find("[data-seagodness-gall]"),i=e.find("[data-seagodness-gall-prev]"),a=e.find("[data-seagodness-gall-next]"),n=e.find("[data-seagodness-text]");e.find("[data-seagodness-gall-item]"),new Swiper(t[0],{nextButton:a,prevButton:i,loop:!0,slidesPerView:5,centeredSlides:!0,initialSlide:-2,onSlideChangeStart:function(){n.text(t.find(".swiper-slide-active").data("text"))},onInit:function(){n.text(t.find(".swiper-slide-active").data("text"))},breakpoints:{640:{slidesPerView:1},1024:{slidesPerView:3}}})}}),app.views.Services=app.views.Default.extend({events:{},initialize:function(){app.views.Services.__super__.initialize.apply(this,arguments)},remove:function(){app.views.Services.__super__.remove.apply(this,arguments)},render:function(){app.views.Services.__super__.render.apply(this,arguments);app.views.Services.__super__.afterRender.apply(this,arguments)}}),app.views.Engraving=app.views.Default.extend({events:{},subView:{ProductsGall:new app.subViews.ProductsGall},initialize:function(){app.views.Engraving.__super__.initialize.apply(this,arguments)},remove:function(){app.views.Engraving.__super__.remove.apply(this,arguments)},render:function(){app.views.Engraving.__super__.render.apply(this,arguments);this.subView.ProductsGall.render(),app.views.Engraving.__super__.afterRender.apply(this,arguments)}}),app.views.ContactsDetail=app.views.Default.extend({events:{},initialize:function(){app.views.ContactsDetail.__super__.initialize.apply(this,arguments)},remove:function(){app.views.ContactsDetail.__super__.remove.apply(this,arguments)},render:function(){app.views.ContactsDetail.__super__.render.apply(this,arguments);var e=this;if(app.GlobalView.mapLoaded)e.shopMap();else{var t=document.createElement("script");t.type="text/javascript",t.src="https://api-maps.yandex.ru/2.1/?lang=ru_RU&onload=initialize",document.body.appendChild(t),window.initialize=function(){app.GlobalView.mapLoaded=!0,e.shopMap()}}e.shops(),e.initFancybox(),e.changeCity(),app.views.ContactsDetail.__super__.afterRender.apply(this,arguments)},changeCity:function(){this.$("[data-contacts-city-select]").on("change",function(){var e="/company/salons"+$(this).val();window.location=e})},initFancybox:function(){this.$("[data-fancy]").fancybox({wrapCSS:"fc-base",loop:!1})},shops:function(){var e=this.$("[data-shop]"),t=e.find("[data-shop-search]"),i=e.find("[data-shop-content]"),a=e.find("[data-shop-all-btn]"),n=e.find("[data-shops-tabs]"),o=n.find("[data-shops-tab]").filter("._active");function s(){n.outerHeight(i.outerHeight(!0)-t.outerHeight(!0)-a.outerHeight(!0))}app.utils.isMobile||(s(),app.on("resize",s,this)),setTimeout(function(){n[0].scrollHeight-n[0].clientHeight>0&&(fleXenv.fleXcrollMain(n[0]),n[0].fleXcroll.setScrollPos(!1,o.position().top))},10)},shopMap:function(){var e=this.$("[data-shop-map]"),t=e.attr("data-xcoord"),i=e.attr("data-ycoord"),a=null;ymaps.ready(function(){!function(){a=new ymaps.Map(e[0],{center:[i,t],zoom:10,autoFitToViewport:"always"});var n=new ymaps.Placemark([i,t],{},{iconLayout:"default#image",iconImageHref:"/static/theme/images/icons/mark.png",iconImageSize:[44,57],iconImageOffset:[-22,-57]});a.geoObjects.add(n)}()})}}),app.views.Constructor=app.views.Default.extend({$stepsTabs:null,$steps:null,events:{},initialize:function(){app.views.Constructor.__super__.initialize.apply(this,arguments)},remove:function(){app.views.Constructor.__super__.remove.apply(this,arguments)},render:function(){app.views.Constructor.__super__.render.apply(this,arguments);this.$steps=this.$("[data-constructor-step]"),this.$stepsTabs=this.$("[data-constructor-step-tab]"),this.changeStep(),this.popupsConst(),this.constructorGall(),this.initSteps(),this.bottomForm(),app.views.Constructor.__super__.afterRender.apply(this,arguments)},popupsConst:function(e){var t=this;$.fancybox({wrapCSS:"fc-base _popups _hide-close",content:e,fitToView:!1,padding:0,helpers:{overlay:{css:{background:"rgba(0, 0, 0, 0.7)"}}},afterShow:function(){var i=e.find("[data-base-form]"),a=(e.find("[data-form-success]"),e.find("[data-form-wrap]"));t.constructorGall(e),t.initSequence(e),t.tabs(e),t.initBaseForm(i),t.initMaskPhone(e),e.find("[data-fc-close]").click(function(){$.fancybox.close()}),i.submit(function(){var e=i.serialize(),t=i.find("[data-form-btn]"),n=!1,o=i.find("[data-form-field]"),s=i.find("[data-form-field-inp]");return t.removeClass("_ok").addClass("_dots"),$.post(i.attr("action"),e,function(e){e.errors&&(n=!0,_.each(e.errors,function(e,t){s.filter('[name="'+t+'"]').siblings(".b-form__field-error").text(e).closest(o).addClass("_error")})),t.removeClass("_dots"),n||(t.addClass("_ok"),a.addClass("_success"),setTimeout(function(){t.removeClass("_ok")},1e3))},"json"),!1})},afterClose:function(){app.trigger("destroySecv")}})},constructorGall:function(e){var t=(e=e||this.$el).find("[data-gal]"),i=e.find("[data-gal-pagination-tpl] span");new Swiper(t,{loop:!1,pagination:"[data-gal-pagination]",paginationClickable:!0,freeMode:!1,centeredSlides:!0,paginationBulletRender:function(e,t){return'<span class="'+t+'"> '+i.eq(e).html()+"</span>"}})},bottomForm:function(){var e=this.$("[data-constructor-bottom-form]");e.submit(function(){var t=e.serialize(),i=e.find("[data-form-btn]"),a=!1,n=e.find("[data-form-field]"),o=e.find("[data-form-field-inp]");return i.removeClass("_ok").addClass("_dots"),$.post(e.attr("action"),t,function(t){t.errors&&(a=!0,_.each(t.errors,function(e,t){o.filter('[name="'+t+'"]').siblings(".b-form__field-error").text(e).closest(n).addClass("_error")})),i.removeClass("_dots"),a||(i.addClass("_ok"),e.addClass("_success"),setTimeout(function(){i.removeClass("_ok")},1e3))},"json"),!1})},initSequence:function(e){(e||this.$el).find("[data-constr-sequence-wrap]").each(function(){var e,t,i=$(this).find("[data-constr-sequence]");if(app.utils.isTablePort||app.utils.isTableLand||app.utils.isMobilePort||app.utils.isMobileLand){var a=i.data("imgs")[0];$(this).css("backgroundImage","url("+a+")")}else t=new app.components.CanvasSequenceUniq({obj:i,width:i.width(),height:i.height(),afterLoad:function(t,a){e=a,i.data("sequence",a),e.animateToLast()},afterLoadFirstImg:function(){},afterSequenceFinish:function(t){e.goToFirst(),e.animateToLast()},afterOneSequence:function(e){}}),app.on("destroySecv",function(){e.length&&e.destroy()}),t.startLoad()})},changeStep:function(){var e=this;e.$stepsTabs.click(function(){e.setStep($(this).data("constructorStepTab"))})},setStep:function(e){this.$steps.hide().filter('[data-constructor-step="'+e+'"]').show(),this.$stepsTabs.removeClass("_active").filter('[data-constructor-step-tab="'+e+'"]').addClass("_active")},initSteps:function(){var e=this,t=e.$("[data-constructor-result-jewel]"),i=e.$("[data-constructor-result-mounting]");function a(){""!=t.val()&&e.$('[data-constructor-item-form] [value="'+t.val()+'"]').closest("[data-constructor-item]").find("[data-constructor-item-link]").click(),""!=i.val()&&e.$('[data-constructor-item-form] [value="'+i.val()+'"]').closest("[data-constructor-item]").find("[data-constructor-item-link]").click()}e.$steps.each(function(){var n=$(this),o=n.find("[data-constructor-left-ajax]"),s=n.find("[data-constructor-item-detail]"),r=null;n.on("change","[data-filter-field]",function(){n.find("[data-filter-form]").submit()}),n.on("submit","[data-filter-form]",function(){var e=n.find("[data-filter-form]");return r=e.serialize(),$.get(e.attr("action"),e.serialize(),function(t){r==e.serialize()&&(o.html($(t.content)),s.html(""),a())},"json"),!1}),o.on("click","[data-constructor-pag-item]",function(){var e=n.find("[data-filter-form]");return r=e.serialize(),$.get($(this).attr("href"),{},function(t){r==e.serialize()&&(o.html($(t.content)),s.html(""),a())},"json"),!1}),o.on("click","[data-constructor-item-link]",function(){var e=$(this),t=n.find("[data-constructor-item]"),i=e.closest(t);t.removeClass("_active"),i.addClass("_active"),s.html(i.find("[data-constructor-item-description]").html())}),s.on("click","[data-constructor-item-del]",function(){var e=n.find("[data-constructor-item]");s.empty(),e.removeClass("_active")}),s.on("submit","[data-constructor-item-form]",function(){var a=$(this);return $.get(a.attr("action"),a.serialize(),function(o){var r=a.find("[data-constructor-item-form-btn]"),l=a.find('[name="SELECT_ACTION"]'),d=a.find('[name="SELECT_ID"]').val();if(r.text()==r.data("constructorItemFormBtn").del)r.text(r.data("constructorItemFormBtn").add),l.val("add"),"1"==n.data("constructorStep")?t.val(""):i.val("");else{r.text(r.data("constructorItemFormBtn").del),l.val("delete");var c=e.$steps.not(n);c.find("[data-constructor-left-ajax]").html(o.content),c.find("[data-filter]").html(o.filter),e.chosen(),""!=o.popup?e.popupsConst($(o.popup)):(s.html(""),"1"==n.data("constructorStep")?(e.setStep(2),t.val(d)):(e.setStep(1),i.val(d)))}},"json"),!1})}),a()}}),app.views.Page=app.views.Default.extend({events:{},initialize:function(){app.views.Page.__super__.initialize.apply(this,arguments)},remove:function(){app.views.Page.__super__.remove.apply(this,arguments)},render:function(){app.views.Page.__super__.render.apply(this,arguments);this.$el.hasClass("not-found")&&app.GlobalView.hideCatalogMenu(),app.views.Page.__super__.afterRender.apply(this,arguments)}}),app.views.Enc=app.views.Default.extend({events:{},initialize:function(){app.views.Enc.__super__.initialize.apply(this,arguments)},remove:function(){app.views.Enc.__super__.remove.apply(this,arguments)},render:function(){app.views.Enc.__super__.render.apply(this,arguments);this.mobFilter(),app.views.Enc.__super__.afterRender.apply(this,arguments)},mobFilter:function(){var e=this.$("[data-filter-btn]"),t=this.$("[data-filter-content]");e.on("click",function(){$(this).toggleClass("_active"),t.slideToggle()})}}),app.views.Reviews=app.views.Default.extend({$addMoreBlock:null,$pagination:null,$catalogItems:null,events:{},initialize:function(){app.views.Reviews.__super__.initialize.apply(this,arguments)},remove:function(){app.views.Reviews.__super__.remove.apply(this,arguments)},render:function(){app.views.Reviews.__super__.render.apply(this,arguments);this.$addMoreBlock=this.$("[data-catalog-add-more-block]"),this.$pagination=this.$("[data-catalog-pagination]"),this.$catalogItems=this.$("[data-catalog-items]"),this.initReverseAnin(),this.addReviews(),this.addMore(),app.views.Reviews.__super__.afterRender.apply(this,arguments)},initReverseAnin:function(){this.$("[data-reverse-anim]").hover(function(){},function(){var e=$(this);e.addClass("_reverse-anim"),setTimeout(function(){e.removeClass("_reverse-anim")},800)})},addReviews:function(){function e(e){var t=e.find("[data-rating-select]"),i=t.find("a"),a=e.find("[data-rating-inp]");i.hover(function(e){var i=$(this).index();t.removeClass("_1 _2 _3 _4 _5").addClass("_"+(i+1)),a.val(i+1)})}app.on("popupShowreviews",function(t){var i=this,a=t.content,n=a.find("form");i.initBaseForm(a.find("form")),e(a.find("form")),n.length&&a.on("submit","form",function(){return n=a.find("form"),$.post(n.attr("action"),n.serialize(),function(t){a.html(t.content),e(n=a.find("form")),i.initBaseForm(n)},"json"),!1})},this)},addMore:function(){var e=this;e.$el.on("click.Reviews.addMore","[data-catalog-add-more]",function(t){var i=$(this);t.preventDefault(),e.startAjasReload(e.$catalogItems),$.post(i.attr("href"),{},function(t){var i=$(t.content);e.$catalogItems.append(i.find("[data-catalog-items]").html()),e.updateScripts(t),e.updatePagination(t.more,t.pag)},"json")}),e.$el.on("click.Reviews.addMore","[data-catalog-pagination-item]",function(t){var i=$(this);t.preventDefault(),e.startAjasReload(e.$catalogItems),$.post(i.attr("href"),{},function(t){var i=$(t.content);e.$catalogItems.html(i.find("[data-catalog-items]").html()),e.updateScripts(t),e.updatePagination(t.more,t.pag)},"json"),$("html, body").animate({scrollTop:e.$catalogItems.offset().top},500)})},updateScripts:function(e){this.initReverseAnin(),this.popups(),app.Router.navigate(e.cururl,{trigger:!1}),this.stopAjasReload(this.$catalogItems)},updatePagination:function(e,t){this.$addMoreBlock.html(e),this.$pagination.html(t)}}),app.views.News=app.views.Default.extend({$addMoreBlock:null,$catalogItems:null,events:{},initialize:function(){app.views.News.__super__.initialize.apply(this,arguments)},remove:function(){app.views.News.__super__.remove.apply(this,arguments)},render:function(){app.views.News.__super__.render.apply(this,arguments);this.$addMoreBlock=this.$("[data-catalog-add-more-block]"),this.$catalogItems=this.$("[data-catalog-items]"),this.initReverseAnin(),this.initSubscription(),this.addMore(),app.views.News.__super__.afterRender.apply(this,arguments)},initReverseAnin:function(){this.$("[data-reverse-anim]").hover(function(){},function(){var e=$(this);e.addClass("_reverse-anim"),setTimeout(function(){e.removeClass("_reverse-anim")},800)})},initSubscription:function(){var e=this.$("[data-subscription-form]"),t=e.find('input[type="email"]'),i=e.find("[data-subscription-form-inner]"),a=e.find("[data-subscription-form-errors]"),n=e.find("[data-subscription-form-success]");e.submit(function(){return $.post(e.attr("action"),e.serialize(),function(e){""!=e.errors?a.text(e.errors).show():(a.hide(),i.hide(),n.fadeIn())},"json"),!1}),t.focus(function(){$(this).addClass("_focus")}),t.blur(function(){""==$(this).val()&&$(this).removeClass("_focus")})},addMore:function(){var e=this;e.$el.on("click.Reviews.addMore","[data-catalog-add-more]",function(t){var i=$(this);t.preventDefault(),e.startAjasReload(e.$catalogItems),$.post(i.attr("href"),{},function(t){var i=$(t.content);e.$catalogItems.append(i.find("[data-catalog-items]").html()),e.updateScripts(t),e.updatePagination(t.more)},"json")}),e.$el.on("click.Reviews.addMore","[data-catalog-pagination-item]",function(t){var i=$(this);t.preventDefault(),e.startAjasReload(e.$catalogItems),$.post(i.attr("href"),{},function(t){var i=$(t.content);e.$catalogItems.html(i.find("[data-catalog-items]").html()),e.updateScripts(t),e.updatePagination(t.more)},"json"),$("html, body").animate({scrollTop:e.$catalogItems.offset().top},500)})},updateScripts:function(e){this.initReverseAnin(),app.Router.navigate(e.cururl,{trigger:!1}),this.stopAjasReload(this.$catalogItems)},updatePagination:function(e){this.$addMoreBlock.html(e)}}),app.views.CollectionLanding=app.views.Default.extend({events:{},initialize:function(){app.views.CollectionLanding.__super__.initialize.apply(this,arguments)},remove:function(){app.views.CollectionLanding.__super__.remove.apply(this,arguments)},render:function(){app.views.CollectionLanding.__super__.render.apply(this,arguments);this.initSwiper(),app.utils.isMobile||this.bgVideo(),app.views.CollectionLanding.__super__.afterRender.apply(this,arguments)},initSwiper:function(){new Swiper("[data-gall]",{direction:"vertical",slidesPerView:1,effect:"fade",nextButton:".swiper-button-next",prevButton:".swiper-button-prev",fade:{crossFade:!0}})},bgVideo:function(){var e=this.$("[data-bg-video]"),t=!1;e.length&&e.each(function(){var e=$(this),i=e.find("video"),a=i[0].videoWidth/i[0].videoHeight,n=e;function o(e){var t,i,o=n.width()/n.height();if(i=e.attr("style"),e.removeAttr("style"),o>a){var s=n.width()/a;t={height:s,width:n.width(),"margin-top":(n.height()-s)/2,"margin-left":0}}else{var r=n.height()*a;t={height:n.height(),width:r,"margin-left":(n.width()-r)/2,"margin-top":0}}e.attr("style",i),e.css(t)}i.on("loadeddata",function(){var e=this;a=e.videoWidth/e.videoHeight,o($(e)),$(window).on("resize",function(){o($(e))}),e.volume=0}).on("canplay",function(){e.addClass("_loaded"),t=!0}).on("timeupdate",function(){if(!t){t=!0,o($(this))}})})}}),app.views.Text=app.views.Default.extend({events:{},initialize:function(){app.views.Text.__super__.initialize.apply(this,arguments)},remove:function(){app.views.Text.__super__.remove.apply(this,arguments)},render:function(){app.views.Text.__super__.render.apply(this,arguments);app.views.Text.__super__.afterRender.apply(this,arguments)}}),app.views.History=app.views.Default.extend({events:{},initialize:function(){app.views.History.__super__.initialize.apply(this,arguments)},remove:function(){app.views.History.__super__.remove.apply(this,arguments)},render:function(){app.views.History.__super__.render.apply(this,arguments);app.views.History.__super__.afterRender.apply(this,arguments)}}),app.views.Partners=app.views.Default.extend({events:{},initialize:function(){app.views.Partners.__super__.initialize.apply(this,arguments)},remove:function(){app.views.Partners.__super__.remove.apply(this,arguments)},render:function(){app.views.Partners.__super__.render.apply(this,arguments);app.views.Partners.__super__.afterRender.apply(this,arguments)}}),app.views.Jewellery=app.views.Default.extend({events:{},initialize:function(){app.views.Jewellery.__super__.initialize.apply(this,arguments)},remove:function(){app.views.Jewellery.__super__.remove.apply(this,arguments)},render:function(){app.views.Jewellery.__super__.render.apply(this,arguments);this.shoppers(),this.collections(),app.views.Jewellery.__super__.afterRender.apply(this,arguments)},shoppers:function(){this.$("[data-shoppers]").masonry({itemSelector:".shopper",columnWidth:".shopper:not(._big)"})},collections:function(){this.$("[data-collection]").each(function(){var e=$(this),t=e.find("[data-collection-popup]"),i=e.find("[data-collection-popup-show]"),a=t.find("[data-collection-popup-close]"),n=t.find("[data-collection-gall]"),o=t.find("[data-collection-gall-prev]"),s=t.find("[data-collection-gall-next]"),r=t.find("[data-collection-gall-slide]"),l=t.find("[data-collection-text-block]"),d=null;i.on("click",function(){app.utils.isMobile&&$("html, body").stop(!0,!0).animate({scrollTop:e.offset().top-app.Header.$el.find("[data-fixed-menu]").height()},500),e.addClass("_active")}),a.on("click",function(){e.removeClass("_active")});new Swiper(n,{loop:!1,nextButton:s,prevButton:o,onSlideChangeStart:function(e){d=r.filter(".swiper-slide-active").data("collectionGallSlide"),l.hide().filter('[data-collection-text-block="'+d+'"]').fadeIn(1e3)}})})}}),app.views.IndividualNew=app.views.Default.extend({events:{},initialize:function(){app.views.Individual.__super__.initialize.apply(this,arguments)},remove:function(){app.views.Individual.__super__.remove.apply(this,arguments)},render:function(){app.views.Individual.__super__.render.apply(this,arguments);this.initSwiperTrends(),this.initSwiperAwards(),this.bottomForm(),this.initFancybox(),this.initGoto(),app.views.Individual.__super__.afterRender.apply(this,arguments)},initFancybox:function(){this.$("[data-fancy]").fancybox({wrapCSS:"fc-base",loop:!1})},initSwiperTrends:function(){var e=this.$("[data-trends]"),t=e.find("[data-trends-gall]"),i=e.find("[data-trends-gall-prev]"),a=e.find("[data-trends-gall-next]"),n=e.find("[data-trends-text]");e.find("[data-trends-gall-item]"),new Swiper(t[0],{nextButton:a,prevButton:i,loop:!0,slidesPerView:5,centeredSlides:!0,initialSlide:-2,onSlideChangeStart:function(){n.text(t.find(".swiper-slide-active").data("text"))},onInit:function(){n.text(t.find(".swiper-slide-active").data("text"))},breakpoints:{640:{slidesPerView:1},1024:{slidesPerView:3}}})},initSwiperAwards:function(){var e=this.$("[data-awards]"),t=e.find("[data-awards-gall]"),i=e.find("[data-awards-gall-prev]"),a=e.find("[data-awards-gall-next]"),n=e.find("[data-awards-text]");e.find("[data-awards-gall-item]"),new Swiper(t[0],{nextButton:a,prevButton:i,loop:!0,slidesPerView:5,centeredSlides:!0,initialSlide:-2,onSlideChangeStart:function(){n.text(t.find(".swiper-slide-active").data("text"))},onInit:function(){n.text(t.find(".swiper-slide-active").data("text"))},breakpoints:{640:{slidesPerView:1},1024:{slidesPerView:3}}})},bottomForm:function(){var e=this,t=e.$("[data-individual-bottom-form]"),i=e.$(".individual__feedback-form");t.submit(function(){var a=t.serialize();return $.post(t.attr("action"),a,function(t){i.html(t.body),e.initBaseForm(),i.find("[data-mask-phone]").mask("+7 (999) 999-99-99"),e.bottomForm()},"json"),!1})}});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){function t(e,t,i){for(e=String(e);e.length<t;)e=String(i)+e;return e}function i(e,t,i,a){for(;e>i;)e-=a;for(;e<t;)e+=a;return e}function a(e){return e.preventDefault(),!1}function n(e,t,i){i&&e.bind(t+"."+r,i)}function o(e,t){var i,a=(t||e).width;if(1048576<a*(t||e).height){if(!(i=document.createElement("canvas"))||!i.getContext||!i.getContext("2d"))return!1;i.width=i.height=1,(i=i.getContext("2d")).fillStyle="FF00FF",i.fillRect(0,0,1,1),i.drawImage(e,1-a,0);try{var n=i.getImageData(0,0,1,1).data;return 255===n[0]&&0===n[1]&&255===n[2]}catch(e){!function(){window.console&&window.console.log&&window.console.log.apply(window.console,arguments)}(e.message,e.stack)}}return!1}var s=window.SpriteSpin={},r=s.namespace="spritespin",l="mousedown mousemove mouseup mouseenter mouseover mouseleave dblclick touchstart touchmove touchend touchcancel selectstart gesturestart gesturechange gestureend".split(" ");s.mods={},s.defaults={source:void 0,width:void 0,height:void 0,frames:void 0,framesX:void 0,lanes:1,module:"360",behavior:"drag",renderer:"canvas",lane:0,frame:0,frameTime:90,animate:!0,reverse:!1,loop:!0,stopFrame:0,wrap:!0,wrapLane:!1,sense:1,senseLane:void 0,orientation:"horizontal",onInit:void 0,onProgress:void 0,onLoad:void 0,onFrame:void 0,onDraw:void 0},s.sourceArray=function(e,i){var a=0,n=0,o=0,s=0,r=i.digits||2;i.frame&&(a=i.frame[0],n=i.frame[1]),i.lane&&(o=i.lane[0],s=i.lane[1]);for(var l,d,c=[];o<=s;o+=1)for(l=a;l<=n;l+=1)d=(d=e.replace("{lane}",t(o,r,0))).replace("{frame}",t(l,r,0)),c.push(d);return c},s.measureSource=function(e){var t,i=e.images[0];(t=new Image).src=i.src,t={width:t.width,height:t.height},1===e.images.length?(e.sourceWidth=t.width,e.sourceHeight=t.height,o(i,t)&&(e.sourceWidth/=2,e.sourceHeight/=2),e.framesX=e.framesX||e.frames,e.frameWidth&&e.frameHeight||(e.framesX?(e.frameWidth=Math.floor(e.sourceWidth/e.framesX),i=Math.ceil(e.frames*e.lanes/e.framesX),e.frameHeight=Math.floor(e.sourceHeight/i)):(e.frameWidth=t.width,e.frameHeight=t.height))):(e.sourceWidth=e.frameWidth=t.width,e.sourceHeight=e.frameHeight=t.height,o(i,t)&&(e.sourceWidth=e.frameWidth=t.width/2,e.sourceHeight=e.frameHeight=t.height/2),e.frames=e.frames||e.images.length)},s.resetInput=function(e){e.startX=e.startY=void 0,e.currentX=e.currentY=void 0,e.oldX=e.oldY=void 0,e.dX=e.dY=e.dW=0,e.ddX=e.ddY=e.ddW=0},s.updateInput=function(e,t){void 0===e.touches&&void 0!==e.originalEvent&&(e.touches=e.originalEvent.touches),t.oldX=t.currentX,t.oldY=t.currentY,void 0!==e.touches&&0<e.touches.length?(t.currentX=e.touches[0].clientX,t.currentY=e.touches[0].clientY):(t.currentX=e.clientX,t.currentY=e.clientY),void 0!==t.startX&&void 0!==t.startY||(t.startX=t.currentX,t.startY=t.currentY,t.clickframe=t.frame,t.clicklane=t.lane),t.dX=t.currentX-t.startX,t.dY=t.currentY-t.startY,t.ddX=t.currentX-t.oldX,t.ddY=t.currentY-t.oldY,t.ndX=t.dX/t.width,t.ndY=t.dY/t.height,t.nddX=t.ddX/t.width,t.nddY=t.ddY/t.height},s.updateFrame=function(e,t,a){if(void 0!==t?e.frame=Number(t):e.animation&&(e.frame+=e.reverse?-1:1),e.animation)e.frame=i(e.frame,0,e.frames-1,e.frames),e.loop||e.frame!==e.stopFrame||(e.animate=!1,s.stopAnimation(e));else if(e.wrap)e.frame=i(e.frame,0,e.frames-1,e.frames);else{t=e.frame;var n=e.frames-1;e.frame=t>n?n:0>t?0:t}void 0!==a&&(e.lane=a,a=e.lane,t=e.lanes-1,e.lane=a>t?t:0>a?0:a),e.target.trigger("onFrame",e),e.target.trigger("onDraw",e)},s.stopAnimation=function(e){e.animation&&(window.clearInterval(e.animation),e.animation=null)},s.setAnimation=function(e){s.stopAnimation(e),e.animate&&(e.animation=window.setInterval(function(){try{s.updateFrame(e)}catch(e){}},e.frameTime))},s.setModules=function(t){var i,a,n;for(i=0;i<t.mods.length;i+=1)"string"==typeof(a=t.mods[i])&&((n=s.mods[a])?t.mods[i]=n:e.error("No module found with name "+a))},s.setLayout=function(e){e.target.attr("unselectable","on").css({"-ms-user-select":"none","-moz-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","user-select":"none"});var t=Math.floor(e.width||e.frameWidth||e.target.innerWidth()),i=Math.floor(e.height||e.frameHeight||e.target.innerHeight());e.target.css({width:t,height:i,position:"relative",overflow:"hidden"});var a={width:"100%",height:"100%",top:0,left:0,bottom:0,right:0,position:"absolute"};e.stage.css(a).hide(),e.canvas&&(e.canvas[0].width=t,e.canvas[0].height=i,e.canvas.css(a).hide())},s.setEvents=function(e){var t,i,o,d=e.target;for(d.unbind("."+r),i=0;i<l.length;i+=1)n(d,l[i],a);for(t=0;t<e.mods.length;t+=1){for(o=e.mods[t],i=0;i<l.length;i+=1)n(d,l[i],o[l[i]]);n(d,"onInit",o.onInit),n(d,"onLoad",o.onLoad),n(d,"onFrame",o.onFrame),n(d,"onDraw",o.onDraw)}n(d,"onLoad",function(e,t){s.setAnimation(t)}),n(d,"onInit",e.onInit),n(d,"onProgress",e.onProgress),n(d,"onLoad",e.onLoad),n(d,"onFrame",e.onFrame),n(d,"onDraw",e.onDraw)},s.boot=function(e){s.setModules(e),s.setLayout(e),s.setEvents(e),e.target.addClass("loading").trigger("onInit",e),function(e){var t,i,a="string"==typeof e.source?[e.source]:e.source,n=0,o=[],s=function(){n+=1,"function"==typeof e.progress&&e.progress({loaded:n,total:a.length,percent:Math.round(n/a.length*100)}),n===o.length&&"function"==typeof e.complete&&e.complete(o)};for(t=0;t<a.length;t+=1)i=new Image,o.push(i),i.onload=i.onabort=i.onerror=s,i.src=a[t]}({source:e.source,progress:function(t){e.target.trigger("onProgress",t)},complete:function(t){e.images=t,s.measureSource(e),e.stage.show(),e.target.removeClass("loading").trigger("onLoad",e).trigger("onFrame",e).trigger("onDraw",e)}})},s.create=function(t){var i=t.target,a=i.data(r);a?e.extend(a,t):((a=e.extend({},s.defaults,t)).source=a.source||[],i.find("img").each(function(){a.source.push(e(this).attr("src"))}),i.empty().addClass("spritespin-instance").append("<div class='spritespin-stage'></div>"),"canvas"===a.renderer&&((t=e("<canvas class='spritespin-canvas'></canvas>")[0]).getContext&&t.getContext("2d")?(a.canvas=e(t),a.context=t.getContext("2d"),i.append(a.canvas),i.addClass("with-canvas")):a.renderer="image"),a.target=i,a.stage=i.find(".spritespin-stage"),i.data(r,a)),"string"==typeof a.source&&(a.source=[a.source]),(a.behavior||a.module)&&(a.mods=[],a.behavior&&a.mods.push(a.behavior),a.module&&a.mods.push(a.module),delete a.behavior,delete a.module),s.boot(a)},s.destroy=function(e){e&&(s.stopAnimation(e),e.target.unbind("."+r),e.target.removeData(r))},s.registerModule=function(t,i){return s.mods[t]&&e.error("Module name is already taken: "+t),i=i||{},s.mods[t]=i},s.Api=function(e){this.data=e},s.extendApi=function(t){var i,a=s.Api.prototype;for(i in t)t.hasOwnProperty(i)&&(a[i]?e.error("API method is already defined: "+i):a[i]=t[i]);return a},e.fn.spritespin=function(t){return"data"===t?this.data(r):"api"===t?new s.Api(this.data(r)):"destroy"===t?e(this).each(function(){s.destroy(e(this).data(r))}):"object"===(void 0===t?"undefined":_typeof(t))?(t.target=t.target||e(this),s.create(t),t.target):e.error("Invalid call to spritespin")}}(window.jQuery||window.Zepto||window.$),function(e,t){function i(i){var a=e(this).spritespin("data");t.updateInput(i,a),a.dragging=!0}function a(){var i=e(this).spritespin("data");t.resetInput(i),i.dragging=!1}function n(i){var a,n=e(this).spritespin("data");if(n.dragging){t.updateInput(i,n),a=0,a="number"==typeof n.orientation?(Number(n.orientation)||0)*Math.PI/180:"horizontal"===n.orientation?0:Math.PI/2,i=Math.sin(a);var o=Math.cos(a);a=n.ndX*i+n.ndY*o,i=(n.ndX*o-n.ndY*i)*n.frames*n.sense,a=a*n.lanes*(n.senseLane||n.sense),i=Math.floor(n.clickframe+i),a=Math.floor(n.clicklane+a),t.updateFrame(n,i,a),n.animate=!1,t.stopAnimation(n)}}t.registerModule("drag",{mousedown:i,mousemove:n,mouseup:a,mouseleave:a,touchstart:i,touchmove:n,touchend:a,touchcancel:a}),t.registerModule("move",{mousemove:function(e){i.call(this,e),n.call(this,e)},mouseleave:a,touchstart:i,touchmove:n,touchend:a,touchcancel:a})}(window.jQuery||window.Zepto||window.$,window.SpriteSpin),function(e,t){var i=Math.floor;t.registerModule("360",{onLoad:function(t,a){var n,o;a.scaleWidth=a.width/a.frameWidth,a.scaleHeight=a.height/a.frameHeight,a.sourceIsSprite=1===a.images.length,a.stage.empty().css({"background-image":"none"}).show(),"canvas"===a.renderer?(a.context.clearRect(0,0,a.width,a.height),a.canvas.show()):"background"===a.renderer?(a.sourceIsSprite?(n=i(a.sourceWidth*a.scaleWidth),o=i(a.sourceHeight*a.scaleHeight)):(n=i(a.frameWidth*a.scaleWidth),o=i(a.frameHeight*a.scaleHeight)),n=[n,"px ",o,"px"].join(""),a.stage.css({"background-repeat":"no-repeat","-webkit-background-size":n,"-moz-background-size":n,"-o-background-size":n,"background-size":n})):"image"===a.renderer&&(a.sourceIsSprite?(n=i(a.sourceWidth*a.scaleWidth),o=i(a.sourceHeight*a.scaleHeight)):n=o="100%",e(a.images).appendTo(a.stage).css({width:n,height:o,position:"absolute"}))},onDraw:function(t,a){if(a.sourceIsSprite){var n=(o=a.lane*a.frames+a.frame)%a.framesX*a.frameWidth,o=a.frameHeight*i(o/a.framesX);"canvas"===a.renderer?(a.context.clearRect(0,0,a.width,a.height),a.context.drawImage(a.images[0],n,o,a.frameWidth,a.frameHeight,0,0,a.width,a.height)):(n=-i(n*a.scaleWidth),o=-i(o*a.scaleHeight),"background"===a.renderer?a.stage.css({"background-image":["url('",a.source[0],"')"].join(""),"background-position":[n,"px ",o,"px"].join("")}):e(a.images).css({top:o,left:n}))}else n=a.lane*a.frames+a.frame,"canvas"===a.renderer?(a.context.clearRect(0,0,a.width,a.height),a.context.drawImage(a.images[n],0,0,a.width,a.height)):"background"===a.renderer?a.stage.css({"background-image":["url('",a.source[n],"')"].join(""),"background-position":"0px 0px"}):(e(a.images).hide(),e(a.images[n]).show())}})}(window.jQuery||window.Zepto||window.$,window.SpriteSpin);var player360={init:function(){$(".photo360").each(function(){player360.play($(this))})},play:function(e){var t=e.attr("id");if(!(0<$("#"+t+"_360canvas ").length)){var i=e.data(),a=t+"_360player";e.wrap('<div id="'+a+'" data-player="'+t+'"></div>');a=$("#"+a);var n=i.width,o=i.height;a.css({position:"relative",width:n,height:o}),e.css({position:"absolute",left:0,top:0,"z-index":1}),a.append('<div id="'+t+'_360canvas"></div>'),$("#"+t+"_360canvas").css({position:"absolute",left:0,top:0,"z-index":2,width:n,height:o}),a.append('<div id="'+t+'_360play" data-player="'+t+'">&raquo;</div>'),$("#"+t+"_360play").css({position:"absolute",width:60,height:60,"background-color":"#444444",color:"#ffffff","font-size":50,"border-radius":30,left:"50%",top:"50%","margin-left":-25,"margin-top":-25,opacity:.6,"text-align":"center",cursor:"pointer","line-height":1,"z-index":3});var s={objId:t,width:n,height:o,source:i.source,digits:i.digits,frames:i.frames,firstFrame:i.firstFrame-1,animate:i.animate,reverse:i.reverse,sense:i.sense,frameTime:i.frameTime};e.data("auto")?this.runPlayer(s):$("#"+t+"_360play").click(function(){player360.runPlayer(s)})}},runPlayer:function(e){$("#"+e.objId+"_360canvas").spritespin({source:SpriteSpin.sourceArray(e.source,{frame:[1,e.frames],digits:e.digits}),width:e.width,height:e.height,animate:e.animate,reverse:!1,frame:e.firstFrame,sense:e.sense,orientation:e.reverse?0:180,frameTime:e.frameTime,onInit:function(){$("#"+e.objId+"_360play").css({"font-size":"18px","line-height":"60px"}).html("0%")},onProgress:function(t,i){$("#"+e.objId+"_360play").html(i.percent+"%")},onLoad:function(){$("#"+e.objId+"_360play").remove()}})},destroy:function(e){$("#"+e+"_360canvas").remove()}};function showTooltip(){var e=document.getElementById("tooltip");document.getElementById("link");return"none"==e.style.display?e.style.display="block":e.style.display="none",!1}$(document).ready(function(){player360.init()}),app.modules.Router=Backbone.Router.extend({_pageCounter:0,routes:{"*href":"baseRout"},baseRout:function(){var e,t=Backbone.history.fragment||"./",i="NotFound";if(this._pageCounter){var a=$.Deferred(),n=$.Deferred();$.when(a,n).done(function(){e.html&&app.GlobalView.show(e)}),app.once("View.goOutDefaultEnd",function(){a.resolve()}),app.once("View.ajax.complete",function(){n.resolve()}),app.GlobalView.hide(),$.get(t+window.location.search,{},function(t){t.jsview&&""!=$.trim(t.jsview)&&((e=new app.views[t.jsview]).setProps(t.body,t.jsview),e.needGoIn=!0,app.trigger("View.ajax.complete"),app.GlobalView.setTitle(t.title),app.GlobalView.selectCurrentMenu(t.sectionId),app.GlobalView.toggleCatalogMenu(t.blockMod))},"json")}else{var o=$("[data-view]");o.length&&""!=$.trim(o.data("view"))&&(i=app.views[o.data("view")],e=new i({el:o}),app.GlobalView.show(e))}this._pageCounter++}}),function(){var e,t;jQuery.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},t={},(e=jQuery.uaMatch(navigator.userAgent)).browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),jQuery.browser=t}(),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),$(function(){app.initialize()}),$(document).ready(function(){$(".info-icon-header img").tooltip({tooltipClass:"phone-tooltip"})}),function(){var e=window.location.hash||!1;if(!window.MutationObserver)return!1;if(-1!=navigator.userAgent.indexOf("MSIE")||-1!=navigator.userAgent.indexOf("Trident")||-1!=navigator.userAgent.indexOf("Edge"))return!1;var t={yaD:!1,yaM:!1,smB:!1},i=new MutationObserver(function(e){e.map(function(e){var i=e.addedNodes[0];!function(e){var i=!1,a={display:"table",opacity:"1",position:"fixed","min-width":"800px","border-collapse":"collapse"};if(e&&"STYLE"===e.tagName&&/(market_context_headcrab_container)|(PD94bWwgdmVyc2lvbj0iMS4wIiB)/.test(e.innerHTML)&&(e.innerText=e.innerText.replace(/transform/g,"")),e&&"DIV"===e.tagName)for(var n in a){if(window.getComputedStyle(e).getPropertyValue(n)!==a[n]){i=!1;break}i=!0}e&&i&&(e&&e.style&&(e.style.transform="translate(-10000px, -10000px)"),!1===t.yaD&&(t.yaD=!0))}(i)})}),a=new MutationObserver(function(){var e=document.documentElement.style.marginTop;e&&parseInt(e)>0&&(document.documentElement.style.marginTop="")}),n=new MutationObserver(function(){var e=document.body.style.marginTop;e&&parseInt(e)>0&&(document.body.style.marginTop="")});e&&"#ssoff"===e||function e(){return document.body?(i&&i.observe(document.body,{childList:!0,subtree:!0}),a&&a.observe(document.documentElement,{attributes:!0,attributeFilter:["style"]}),void(n&&n.observe(document.body,{attributes:!0,attributeFilter:["style"]}))):void setTimeout(e,100)}()}();